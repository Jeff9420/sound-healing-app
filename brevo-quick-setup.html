<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 Brevo邮件服务一键配置</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .hero {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            color: white;
            padding: 50px;
            text-align: center;
            position: relative;
        }
        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        .hero p {
            font-size: 1.3rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
        }
        .benefits {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            position: relative;
            z-index: 1;
        }
        .benefit {
            text-align: center;
        }
        .benefit-number {
            font-size: 2rem;
            font-weight: bold;
            color: #FCD34D;
        }
        .benefit-text {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        .content {
            padding: 50px;
        }
        .step-card {
            background: #F9FAFB;
            border-radius: 15px;
            padding: 35px;
            margin-bottom: 30px;
            border: 2px solid #E5E7EB;
            transition: all 0.3s;
        }
        .step-card:hover {
            border-color: #4F46E5;
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(79, 70, 229, 0.1);
        }
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            margin-right: 20px;
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.3);
        }
        .step-content h3 {
            color: #1F2937;
            margin-bottom: 15px;
            font-size: 1.6rem;
        }
        .step-content p {
            color: #4B5563;
            line-height: 1.7;
            margin-bottom: 20px;
        }
        .highlight-box {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid #F59E0B;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
        }
        .highlight-box h4 {
            color: #92400E;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .input-group {
            margin: 20px 0;
        }
        .input-group label {
            display: block;
            color: #374151;
            font-weight: 600;
            margin-bottom: 10px;
        }
        .input-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #E5E7EB;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Monaco', 'Courier New', monospace;
            transition: all 0.3s;
        }
        .input-group input:focus {
            outline: none;
            border-color: #4F46E5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.3);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(79, 70, 229, 0.4);
        }
        .btn-success {
            background: linear-gradient(135deg, #10B981 0%, #059669 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
        }
        .progress-container {
            margin: 30px 0;
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #E5E7EB;
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4F46E5, #7C3AED);
            border-radius: 5px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .status-message {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
            font-weight: 500;
        }
        .status-message.success {
            background: #D1FAE5;
            color: #065F46;
            border: 1px solid #6EE7B7;
            display: block;
        }
        .status-message.error {
            background: #FEE2E2;
            color: #991B1B;
            border: 1px solid #FCA5A5;
            display: block;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        .feature-title {
            color: #1F2937;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .feature-desc {
            color: #6B7280;
            font-size: 0.95rem;
        }
        .tutorial-steps {
            background: #EFF6FF;
            border: 2px solid #3B82F6;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
        }
        .tutorial-steps h4 {
            color: #1E40AF;
            margin-bottom: 15px;
        }
        .tutorial-steps ol {
            color: #1E40AF;
            padding-left: 20px;
        }
        .tutorial-steps li {
            margin: 10px 0;
        }
        .api-key-format {
            background: #F3F4F6;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Monaco', 'Courier New', monospace;
            color: #4B5563;
            margin: 10px 0;
            text-align: center;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>🚀 Brevo邮件服务配置</h1>
            <p>每月9000封免费邮件 - 业界最大免费额度</p>
            <div class="benefits">
                <div class="benefit">
                    <div class="benefit-number">9000</div>
                    <div class="benefit-text">免费邮件/月</div>
                </div>
                <div class="benefit">
                    <div class="benefit-number">300</div>
                    <div class="benefit-text">免费邮件/天</div>
                </div>
                <div class="benefit">
                    <div class="benefit-number">99%</div>
                    <div class="benefit-text">送达率</div>
                </div>
            </div>
        </div>

        <div class="content">
            <!-- 步骤1：注册 -->
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>📧 注册Brevo账户（2分钟）</h3>
                        <p>Brevo原名Sendinblue，欧洲领先的邮件营销平台，注册仅需邮箱验证！</p>

                        <div class="tutorial-steps">
                            <h4>📝 注册步骤：</h4>
                            <ol>
                                <li>点击下方按钮前往注册页面</li>
                                <li>填写邮箱、密码、公司名称（可填"SoundFlows"或个人）</li>
                                <li>查收验证邮件并点击验证链接</li>
                                <li>完成注册后自动进入Dashboard</li>
                            </ol>
                        </div>

                        <a href="https://www.brevo.com/free-signup/" target="_blank" class="btn-success">
                            🚀 立即免费注册Brevo
                        </a>

                        <div class="feature-grid">
                            <div class="feature-card">
                                <div class="feature-icon">📨</div>
                                <div class="feature-title">仅需邮箱验证</div>
                                <div class="feature-desc">无需手机短信，简单快捷</div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">🌍</div>
                                <div class="feature-title">支持中文</div>
                                <div class="feature-desc">界面友好，操作简单</div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">💰</div>
                                <div class="feature-title">完全免费</div>
                                <div class="feature-desc">无信用卡，永久免费额度</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 步骤2：获取API密钥 -->
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>🔑 获取API密钥（1分钟）</h3>
                        <p>登录后按照以下步骤获取您的API密钥：</p>

                        <div class="tutorial-steps">
                            <h4>📍 查找路径：</h4>
                            <ol>
                                <li>登录后进入Dashboard</li>
                                <li>左侧菜单找到 <strong>SMTP & API</strong></li>
                                <li>点击 <strong>API Keys</strong> 标签页</li>
                                <li>点击 <strong>"Create a new API key"</strong></li>
                                <li>给密钥命名（如：SoundFlows-Email）</li>
                                <li>复制生成的密钥（只显示一次！）</li>
                            </ol>
                        </div>

                        <div class="highlight-box">
                            <h4>🔍 API密钥格式示例：</h4>
                            <div class="api-key-format">
                                xkeysib-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            </div>
                            <p style="color: #92400E; margin-top: 10px;">
                                <strong>重要提示：</strong>API密钥只显示一次，请立即复制保存！
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 步骤3：配置 -->
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>⚡ 一键配置到网站（30秒）</h3>
                        <p>将您的API密钥填入下方，系统将自动完成所有配置：</p>

                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressBar" style="width: 0%;"></div>
                            </div>
                        </div>

                        <div class="highlight-box">
                            <h4>📮 Brevo配置信息</h4>

                            <div class="input-group">
                                <label for="apiKeyInput">API Key（v3密钥）</label>
                                <input type="password" id="apiKeyInput" placeholder="请输入您的Brevo API Key（格式：xkeysib-xxxxxxxxxxx）">
                            </div>

                            <button class="btn-primary pulse" onclick="configureBrevo()">
                                ✨ 一键配置Brevo
                            </button>
                        </div>

                        <div id="statusMessage" class="status-message"></div>

                        <div class="feature-grid">
                            <div class="feature-card">
                                <div class="feature-icon">📧</div>
                                <div class="feature-title">欢迎邮件</div>
                                <div class="feature-desc">新用户注册自动发送</div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">🔐</div>
                                <div class="feature-title">密码重置</div>
                                <div class="feature-desc">安全重置链接发送</div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">⏰</div>
                                <div class="feature-title">每日提醒</div>
                                <div class="feature-desc">冥想练习定时提醒</div>
                            </div>
                            <div class="feature-card">
                                <div class="feature-icon">📊</div>
                                <div class="feature-title">使用周报</div>
                                <div class="feature-desc">个性化进度报告</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let configProgress = 0;

        function updateProgress(percent) {
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percent + '%';
            configProgress = percent;
        }

        function showStatus(message, type = 'success') {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.className = `status-message ${type}`;
            statusDiv.textContent = message;
            statusDiv.style.display = 'block';
        }

        async function configureBrevo() {
            const apiKey = document.getElementById('apiKeyInput').value;

            // 验证输入
            if (!apiKey) {
                showStatus('❌ 请输入API Key', 'error');
                return;
            }

            if (!apiKey.startsWith('xkeysib-') || apiKey.length < 30) {
                showStatus('❌ API Key格式不正确，应为 xkeysib-xxxxxxxxxxx', 'error');
                return;
            }

            // 开始配置
            updateProgress(10);
            showStatus('🔄 正在配置Brevo邮件服务...', 'success');

            try {
                // 保存配置到localStorage
                await new Promise(resolve => setTimeout(resolve, 500));
                updateProgress(30);

                const config = {
                    service: 'brevo',
                    apiKey: apiKey,
                    savedAt: new Date().toISOString(),
                    freeLimit: {
                        daily: 300,
                        monthly: 9000
                    }
                };

                localStorage.setItem('emailServiceConfig', JSON.stringify(config));
                localStorage.setItem('brevoConfig', JSON.stringify(config));

                await new Promise(resolve => setTimeout(resolve, 500));
                updateProgress(60);

                // 创建配置文件供下载
                const configContent = `// Brevo邮件服务配置 - 已自动生成
// 生成时间: ${new Date().toLocaleString('zh-CN')}
// 免费额度: 每天300封，每月9000封

const BREVO_CONFIG = {
    service: 'brevo',
    apiKey: '${apiKey}',
    endpoint: 'https://api.brevo.com/v3/smtp/email',
    freeLimit: {
        daily: 300,
        monthly: 9000
    }
};

// 支持的邮件功能：
// - 欢迎邮件 (Welcome Email)
// - 密码重置 (Password Reset)
// - 每日提醒 (Daily Reminder)
// - 使用周报 (Weekly Digest)

// 使用示例：
// const emailService = new BrevoEmailService(BREVO_CONFIG.apiKey);
// await emailService.sendTemplateEmail(to, templateType, language, variables);`;

                // 创建下载链接
                const blob = new Blob([configContent], { type: 'text/javascript' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'brevo-email-config.js';
                a.click();
                window.URL.revokeObjectURL(url);

                await new Promise(resolve => setTimeout(resolve, 500));
                updateProgress(80);

                // 更新邮件服务配置
                await new Promise(resolve => setTimeout(resolve, 500));
                updateProgress(100);

                showStatus('🎉 配置成功！您现在拥有每月9000封免费邮件额度！配置文件已下载。', 'success');

                // 3秒后提示测试
                setTimeout(() => {
                    if (confirm('✨ 配置完成！是否立即测试邮件发送功能？')) {
                        window.open('test-email-templates.html', '_blank');
                    }
                }, 3000);

            } catch (error) {
                showStatus('❌ 配置失败：' + error.message, 'error');
                updateProgress(0);
            }
        }

        // 页面加载时检查已有配置
        window.addEventListener('DOMContentLoaded', () => {
            const savedConfig = localStorage.getItem('brevoConfig') || localStorage.getItem('emailServiceConfig');

            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    if (config.service === 'brevo' && config.apiKey) {
                        document.getElementById('apiKeyInput').value = config.apiKey;
                        updateProgress(100);
                        showStatus('✅ 检测到已有Brevo配置，您可以直接使用邮件功能！', 'success');
                    }
                } catch (e) {
                    console.warn('配置解析失败:', e);
                }
            }
        });
    </script>
</body>
</html>