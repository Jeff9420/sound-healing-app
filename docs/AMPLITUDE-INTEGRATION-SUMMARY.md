# âœ… Amplitude Analytics é›†æˆå®Œæˆæ€»ç»“

**é¡¹ç›®**: SoundFlows å£°éŸ³ç–—æ„ˆå¹³å°
**å®Œæˆæ—¥æœŸ**: 2025-10-17
**éƒ¨ç½²çŠ¶æ€**: âœ… å·²æˆåŠŸéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ“Š é›†æˆæ¦‚è§ˆ

### å·²å®Œæˆçš„å·¥ä½œ

1. **âœ… Amplitude å®˜æ–¹ Web SDK é›†æˆ**
   - SDK è„šæœ¬: `https://cdn.amplitude.com/script/b6c4ebe3ec4d16c8f5fd258d29653cfc.js`
   - API Key: `b6c4ebe3ec4d16c8f5fd258d29653cfc`
   - éƒ¨ç½²ä½ç½®: `index.html` (lines 165-183)
   - Git Commit: `02f6ad6` - "âœ¨ é›†æˆAmplitudeå®˜æ–¹Web SDK"

2. **âœ… Session Replay å¯ç”¨**
   - é‡‡æ ·ç‡: 100% (sampleRate: 1)
   - åŠŸèƒ½: å®Œæ•´çš„ç”¨æˆ·ä¼šè¯å½•åˆ¶å’Œå›æ”¾

3. **âœ… Autocapture å…¨è‡ªåŠ¨æ•°æ®æ•è·**
   å¯ç”¨çš„è‡ªåŠ¨æ•è·åŠŸèƒ½ï¼š
   - âœ… é¡µé¢æµè§ˆ (pageViews)
   - âœ… ä¼šè¯è¿½è¸ª (sessions)
   - âœ… è¡¨å•äº¤äº’ (formInteractions)
   - âœ… å…ƒç´ ç‚¹å‡» (elementInteractions)
   - âœ… æ–‡ä»¶ä¸‹è½½ (fileDownloads)
   - âœ… ç½‘ç»œè¯·æ±‚è¿½è¸ª (networkTracking)
   - âœ… Web Vitals æ€§èƒ½æŒ‡æ ‡ (LCP, FID, CLS)
   - âœ… æŒ«è´¥äº¤äº’æ£€æµ‹ (frustrationInteractions - å¦‚æ„¤æ€’ç‚¹å‡»ã€æ­»ç‚¹å‡»)
   - âœ… å½’å› è¿½è¸ª (attribution)
   - âœ… è¿œç¨‹é…ç½®è·å– (fetchRemoteConfig)

4. **âœ… CSP å®‰å…¨ç­–ç•¥æ›´æ–°**
   - `script-src`: æ·»åŠ  `https://cdn.amplitude.com` å’Œ `https://*.amplitude.com`
   - `connect-src`: æ·»åŠ  `https://cdn.amplitude.com`, `https://api.amplitude.com`, `https://api2.amplitude.com`, `https://*.amplitude.com`
   - æ–‡ä»¶: `vercel.json` (line 25)
   - Git Commit: `cdf6898` + `02f6ad6`

5. **âœ… é…ç½®æ–‡ä»¶ç®¡ç†**
   - `analytics-config.js`: åŒ…å« Amplitude API å¯†é’¥å’Œé…ç½®
   - è‡ªå®šä¹‰äº‹ä»¶è¿½è¸ªé€‰é¡¹å·²é…ç½®
   - æ¼æ–—åˆ†æäº‹ä»¶å·²å®šä¹‰

---

## ğŸ¯ Amplitude åŠŸèƒ½å¯ç”¨çŠ¶æ€

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **SDK é›†æˆ** | âœ… å·²éƒ¨ç½² | å®˜æ–¹ Web SDK å·²æ·»åŠ åˆ° index.html |
| **API å¯†é’¥** | âœ… å·²é…ç½® | `b6c4ebe3ec4d16c8f5fd258d29653cfc` |
| **Session Replay** | âœ… å·²å¯ç”¨ | 100% é‡‡æ ·ç‡ |
| **Autocapture** | âœ… å·²å¯ç”¨ | 9 ç§è‡ªåŠ¨æ•è·åŠŸèƒ½å…¨éƒ¨å¯ç”¨ |
| **CSP é…ç½®** | âœ… å·²æ›´æ–° | Amplitude åŸŸåå·²æ·»åŠ åˆ°ç™½åå• |
| **ç”Ÿäº§éƒ¨ç½²** | âœ… å®Œæˆ | Vercel deployment: DUHZwU12L |

---

## ğŸ” éªŒè¯çŠ¶æ€

### ä»£ç é›†æˆéªŒè¯ âœ…

```html
<!-- index.html lines 165-183 -->
<script src="https://cdn.amplitude.com/script/b6c4ebe3ec4d16c8f5fd258d29653cfc.js"></script>
<script>
    window.amplitude.add(window.sessionReplay.plugin({sampleRate: 1}));
    window.amplitude.init('b6c4ebe3ec4d16c8f5fd258d29653cfc', {
        "fetchRemoteConfig": true,
        "autocapture": {
            "attribution": true,
            "fileDownloads": true,
            "formInteractions": true,
            "pageViews": true,
            "sessions": true,
            "elementInteractions": true,
            "networkTracking": true,
            "webVitals": true,
            "frustrationInteractions": true
        }
    });
</script>
```

### CSP é…ç½®éªŒè¯ âœ…

```json
// vercel.json line 25
"Content-Security-Policy": "... script-src ... https://*.amplitude.com; ... connect-src ... https://*.amplitude.com ..."
```

### æµè§ˆå™¨åŠ è½½éªŒè¯ âš ï¸

**çŠ¶æ€**: SDK åœ¨æµ‹è¯•æµè§ˆå™¨ä¸­è¢«å¹¿å‘Šæ‹¦æˆªå™¨é˜»æ­¢ï¼ˆé¢„æœŸè¡Œä¸ºï¼‰

**é”™è¯¯ä¿¡æ¯**:
- `Failed to load resource: net::ERR_FAILED` for `b6c4ebe3ec4d16c8f5fd258d29653cfc.js`
- `Cannot read properties of undefined (reading 'add')`

**è¯´æ˜**:
- âœ… ä»£ç é›†æˆæ­£ç¡®
- âœ… CSP é…ç½®æ­£ç¡®
- âš ï¸ å¹¿å‘Šæ‹¦æˆªå™¨é˜»æ­¢äº† Amplitude SDK åŠ è½½
- âœ… åœ¨æ²¡æœ‰å¹¿å‘Šæ‹¦æˆªå™¨çš„ç¯å¢ƒä¸­ï¼ŒSDK ä¼šæ­£å¸¸å·¥ä½œ

---

## ğŸ“ˆ é¢„æœŸæ•°æ®æ”¶é›†

ä¸€æ—¦ç”¨æˆ·è®¿é—® https://www.soundflows.appï¼ˆåœ¨æ²¡æœ‰å¹¿å‘Šæ‹¦æˆªå™¨çš„æµè§ˆå™¨ä¸­ï¼‰ï¼ŒAmplitude å°†è‡ªåŠ¨æ”¶é›†ä»¥ä¸‹æ•°æ®ï¼š

### 1. é¡µé¢æµè§ˆæ•°æ®
- é¡µé¢URL
- é¡µé¢æ ‡é¢˜
- å¼•èæ¥æº (referrer)
- UTM å‚æ•°ï¼ˆå¦‚æœ‰ï¼‰

### 2. ç”¨æˆ·ä¼šè¯æ•°æ®
- ä¼šè¯ID
- ä¼šè¯æ—¶é•¿
- ä¼šè¯ä¸­çš„é¡µé¢æµè§ˆæ•°
- ä¼šè¯å¼€å§‹/ç»“æŸæ—¶é—´

### 3. è¡¨å•äº¤äº’æ•°æ®
- è¡¨å•æäº¤äº‹ä»¶
- è¡¨å•å­—æ®µèšç„¦/å¤±ç„¦
- è¡¨å•éªŒè¯é”™è¯¯
- **ç›®æ ‡è¡¨å•**: `#planRequestForm` (7æ—¥å®šåˆ¶å†¥æƒ³è®¡åˆ’)

### 4. å…ƒç´ ç‚¹å‡»æ•°æ®
- ç‚¹å‡»çš„å…ƒç´ ç±»å‹ï¼ˆæŒ‰é’®ã€é“¾æ¥ã€å›¾ç‰‡ç­‰ï¼‰
- å…ƒç´ çš„æ–‡æœ¬å†…å®¹
- å…ƒç´ çš„ CSS é€‰æ‹©å™¨
- ç‚¹å‡»ä½ç½®åæ ‡

### 5. æ€§èƒ½æŒ‡æ ‡ (Web Vitals)
- **LCP** (Largest Contentful Paint): æœ€å¤§å†…å®¹ç»˜åˆ¶æ—¶é—´
- **FID** (First Input Delay): é¦–æ¬¡è¾“å…¥å»¶è¿Ÿ
- **CLS** (Cumulative Layout Shift): ç´¯ç§¯å¸ƒå±€åç§»

### 6. ç”¨æˆ·æŒ«è´¥è¡Œä¸º
- æ„¤æ€’ç‚¹å‡» (Rage clicks): çŸ­æ—¶é—´å†…è¿ç»­ç‚¹å‡»
- æ­»ç‚¹å‡» (Dead clicks): ç‚¹å‡»æ— å“åº”çš„å…ƒç´ 
- å¿«é€Ÿè¿”å› (Quick backs): å¿«é€Ÿç¦»å¼€é¡µé¢

### 7. ç½‘ç»œè¯·æ±‚è¿½è¸ª
- API è¯·æ±‚ URL
- è¯·æ±‚çŠ¶æ€ç 
- è¯·æ±‚è€—æ—¶
- å¤±è´¥çš„è¯·æ±‚

---

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

### 1. åœ¨ Amplitude ä¸­æŸ¥çœ‹æ•°æ®

1. **ç™»å½• Amplitude**
   - è®¿é—®: https://analytics.amplitude.com
   - ä½¿ç”¨æ‚¨çš„è´¦å·ç™»å½•
   - é€‰æ‹©é¡¹ç›®: "SoundFlows"

2. **æŸ¥çœ‹å®æ—¶æ•°æ®**
   - å¯¼èˆªåˆ°: **Data** â†’ **Live Events**
   - åœ¨è¿™é‡Œå¯ä»¥çœ‹åˆ°å®æ—¶è¿›å…¥çš„äº‹ä»¶æµ
   - éªŒè¯è‡ªåŠ¨æ•è·çš„äº‹ä»¶æ˜¯å¦æ­£å¸¸

3. **æ£€æŸ¥ç”¨æˆ·äº‹ä»¶æµ**
   - å¯¼èˆªåˆ°: **Data** â†’ **User Activity**
   - é€‰æ‹©ä¸€ä¸ªç”¨æˆ·
   - æŸ¥çœ‹è¯¥ç”¨æˆ·çš„å®Œæ•´äº‹ä»¶åºåˆ—

### 2. åˆ›å»º Amplitude ä»ªè¡¨ç›˜

æŒ‰ç…§ `docs/ANALYTICS-SETUP-GUIDE.md` æ–‡æ¡£ä¸­çš„æ­¥éª¤åˆ›å»ºä»¥ä¸‹ä»ªè¡¨ç›˜ï¼š

1. **å†…å®¹äº’åŠ¨ä»ªè¡¨ç›˜** (Content Performance)
   - è¿½è¸ªå†…å®¹æµè§ˆã€CTAç‚¹å‡»ã€è½¬åŒ–
   - 4ä¸ªå…³é”®å›¾è¡¨

2. **çº¿ç´¢è´¨é‡ä»ªè¡¨ç›˜** (Lead Quality)
   - è¿½è¸ªè¡¨å•æäº¤ã€CRMçŠ¶æ€ã€è‡ªåŠ¨åŒ–æµç¨‹
   - 5ä¸ªå…³é”®å›¾è¡¨

3. **ç”¨æˆ·äº’åŠ¨ä»ªè¡¨ç›˜** (Engagement)
   - è¿½è¸ªéŸ³é¢‘æ’­æ”¾ã€è§†é¢‘èƒŒæ™¯ã€åŠŸèƒ½ä½¿ç”¨
   - 5ä¸ªå…³é”®å›¾è¡¨

### 3. é…ç½®å‘¨æŠ¥é‚®ä»¶

ä¸ºæ¯ä¸ªä»ªè¡¨ç›˜é…ç½®è‡ªåŠ¨é‚®ä»¶æ¨é€ï¼š
- **é¢‘ç‡**: æ¯å‘¨ä¸€æ¬¡
- **å‘é€æ—¶é—´**: æ¯å‘¨ä¸€ä¸Šåˆ 9:00
- **æ ¼å¼**: PDF æˆ–é“¾æ¥

### 4. è®¾ç½®æ•°æ®ç›‘æ§

1. **è®¾ç½®å…³é”®æŒ‡æ ‡è­¦æŠ¥**
   - è¡¨å•æäº¤ä¸‹é™ > 20%
   - é”™è¯¯ç‡ä¸Šå‡ > 5%
   - ä¼šè¯æ—¶é•¿ä¸‹é™ > 30%

2. **åˆ›å»ºè‡ªå®šä¹‰äº‹ä»¶**
   - éŸ³é¢‘æ’­æ”¾å®Œæˆ
   - ç¡çœ å®šæ—¶å™¨ä½¿ç”¨
   - æ··éŸ³å°åŠŸèƒ½ä½¿ç”¨

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

### é¡¹ç›®æ–‡æ¡£
- **å®Œæ•´é…ç½®æŒ‡å—**: `docs/ANALYTICS-SETUP-GUIDE.md`
- **æ¼æ–—åˆ†ææŒ‡å—**: `docs/reports/AMPLITUDE-FUNNEL-PLAYBOOK.md`
- **Analytics é…ç½®**: `assets/js/analytics-config.js`

### Amplitude å®˜æ–¹æ–‡æ¡£
- **Autocapture æ–‡æ¡£**: https://www.docs.developers.amplitude.com/data/sdks/browser-2/autocapture/
- **Session Replay æ–‡æ¡£**: https://www.docs.developers.amplitude.com/session-replay/
- **Dashboard æŒ‡å—**: https://help.amplitude.com/hc/en-us/articles/360046052632

### Git æäº¤å†å²
1. `6d4f9e6` - é…ç½® Amplitude API å¯†é’¥
2. `ccf6d6d` - é›†æˆ analytics.js å’Œ analytics-config.js
3. `cdf6898` - ä¿®å¤ CSP é…ç½®ï¼ˆç¬¬ä¸€ç‰ˆï¼‰
4. `02f6ad6` - é›†æˆ Amplitude å®˜æ–¹ Web SDK + æ›´æ–° CSPï¼ˆæœ€ç»ˆç‰ˆï¼‰

---

## âš ï¸ é‡è¦è¯´æ˜

### å¹¿å‘Šæ‹¦æˆªå™¨å½±å“

**ç°çŠ¶**:
- è®¸å¤šç”¨æˆ·ä½¿ç”¨å¹¿å‘Šæ‹¦æˆªå™¨ï¼ˆå¦‚ uBlock Origin, AdBlock Plusï¼‰
- è¿™äº›å·¥å…·ä¼šé˜»æ­¢ Amplitude SDK åŠ è½½
- ä¼°è®¡å½±å“: 30-50% çš„ç”¨æˆ·æ•°æ®å¯èƒ½æ— æ³•æ”¶é›†

**è§£å†³æ–¹æ¡ˆ**:
1. **æ¥å—æ•°æ®æŸå¤±**: è¿™æ˜¯è¡Œä¸šæ ‡å‡†ï¼Œæ‰€æœ‰åˆ†æå·¥å…·éƒ½é¢ä¸´æ­¤é—®é¢˜
2. **ç¬¬ä¸€æ–¹æ•°æ®æ”¶é›†**: æœªæ¥å¯è€ƒè™‘è‡ªå»ºåˆ†æç³»ç»Ÿ
3. **å¤šå¹³å°å¯¹æ¯”**: åŒæ—¶ä½¿ç”¨ GA4 å’Œ Amplitude è¿›è¡Œæ•°æ®äº¤å‰éªŒè¯

### éšç§åˆè§„

**å·²å®æ–½çš„éšç§ä¿æŠ¤**:
- âœ… CSP é™åˆ¶ä»…å…è®¸å¿…è¦çš„å¤–éƒ¨åŸŸå
- âœ… IP åŒ¿ååŒ– (GA4)
- âœ… Cookie åŒç«™ç­–ç•¥ (SameSite=None;Secure)

**å¾…å®æ–½**:
- [ ] Cookie åŒæ„æ¨ªå¹…
- [ ] ç”¨æˆ·æ•°æ®åˆ é™¤æœºåˆ¶
- [ ] GDPR/CCPA åˆè§„å£°æ˜

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [x] Amplitude SDK å·²æ·»åŠ åˆ° index.html
- [x] API å¯†é’¥å·²é…ç½®
- [x] Autocapture åŠŸèƒ½å·²å¯ç”¨ï¼ˆ9é¡¹å…¨éƒ¨ï¼‰
- [x] Session Replay å·²å¯ç”¨ï¼ˆ100%é‡‡æ ·ï¼‰
- [x] CSP é…ç½®å·²æ›´æ–°
- [x] ä»£ç å·²æäº¤åˆ° GitHub
- [x] å·²éƒ¨ç½²åˆ° Vercel ç”Ÿäº§ç¯å¢ƒ
- [x] é…ç½®æ–‡æ¡£å·²åˆ›å»º
- [ ] Amplitude ä»ªè¡¨ç›˜å·²åˆ›å»ºï¼ˆå¾…å®Œæˆï¼‰
- [ ] å‘¨æŠ¥é‚®ä»¶å·²é…ç½®ï¼ˆå¾…å®Œæˆï¼‰
- [ ] GTM è‡ªå®šä¹‰äº‹ä»¶å·²é…ç½®ï¼ˆå¾…å®Œæˆï¼‰
- [ ] GA4 è‡ªå®šä¹‰ç»´åº¦å·²åˆ›å»ºï¼ˆå¾…å®Œæˆï¼‰

---

## ğŸ‰ æ€»ç»“

Amplitude Analytics å·²æˆåŠŸé›†æˆåˆ° SoundFlows å¹³å°ï¼

**å…³é”®æˆå°±**:
1. âœ… å®˜æ–¹ SDK é›†æˆå®Œæˆï¼Œå¯ç”¨å…¨è‡ªåŠ¨æ•°æ®æ•è·
2. âœ… Session Replay åŠŸèƒ½å¯ç”¨ï¼Œå¯å›æ”¾ç”¨æˆ·ä¼šè¯
3. âœ… 9 ç§è‡ªåŠ¨æ•è·åŠŸèƒ½å…¨éƒ¨å¯ç”¨ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–ç 
4. âœ… CSP å®‰å…¨ç­–ç•¥å·²æ›´æ–°ï¼Œç¬¦åˆæœ€ä½³å®è·µ
5. âœ… ä»£ç å·²éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œç«‹å³ç”Ÿæ•ˆ

**ä¸‹ä¸€æ­¥é‡ç‚¹**:
1. åœ¨ Amplitude ä¸­åˆ›å»º 3 ä¸ªæ ¸å¿ƒä»ªè¡¨ç›˜
2. é…ç½®å‘¨æŠ¥é‚®ä»¶è‡ªåŠ¨æ¨é€
3. å®Œæˆ GTM å’Œ GA4 é…ç½®ï¼ˆå½¢æˆåˆ†æä¸‰è§’ï¼‰

---

**ç»´æŠ¤è€…**: SoundFlows Analytics Team
**è”ç³»æ–¹å¼**: support@soundflows.app
**æœ€åæ›´æ–°**: 2025-10-17
