<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="build-version" content="v3.0.0-ui-redesign-20251108">
    <!-- 🚀 FIXED EMOJI ENCODING: 2025-11-08 - Restored from commit 64dd550 -->

    <!-- Primary Meta Tags -->
    <title>声音疗愈 SoundFlows | 免费在线冥想音乐、雨声白噪音、助眠放松音效</title>
    <meta name="title" content="声音疗愈 SoundFlows | 免费在线冥想音乐、雨声白噪音、助眠放松音效">
    <meta name="description" content="SoundFlows 声音疗愈平台提供213+免费音频：雨声助眠、白噪音专注、冥想音乐、脉轮疗愈、焦虑缓解。无需下载APP，浏览器直接播放，科学改善睡眠、专注力和情绪健康。">
    <meta name="keywords" content="声音疗愈,冥想音乐,雨声睡眠,白噪音,自然音效,睡眠音乐,放松音乐,减压音乐,颂钵音疗,脉轮疗愈,催眠音频,潜意识疗法,助眠音频,专注力音乐,焦虑缓解,情绪疗愈">
    <meta name="author" content="Sound Healing Team">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="language" content="zh-Hans">
    <meta name="revisit-after" content="7 days">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.soundflows.app/zh/">

    <!-- Alternate Language Versions (hreflang) - Path-based multilingual structure -->
    <link rel="alternate" hreflang="en" href="https://www.soundflows.app/en/">
    <link rel="alternate" hreflang="zh-Hans" href="https://www.soundflows.app/zh/">
    <link rel="alternate" hreflang="x-default" href="https://www.soundflows.app/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.soundflows.app/zh/">
    <meta property="og:title" content="声音疗愈 SoundFlows | 免费在线冥想音乐、雨声白噪音、助眠放松音效">
    <meta property="og:description" content="SoundFlows 声音疗愈平台提供213+免费音频：雨声助眠、白噪音专注、冥想音乐、脉轮疗愈、焦虑缓解。无需下载APP，浏览器直接播放。">
    <meta property="og:image" content="https://www.soundflows.app/assets/images/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="SoundFlows 声音疗愈 - 免费雨声白噪音助眠音乐">
    <meta property="og:site_name" content="SoundFlows 声音疗愈">
    <meta property="og:locale" content="zh_CN">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:locale:alternate" content="ja_JP">
    <meta property="og:locale:alternate" content="ko_KR">
    <meta property="og:locale:alternate" content="es_ES">
    <meta property="og:updated_time" content="2025-10-01T00:00:00+00:00">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.soundflows.app/zh/">
    <meta name="twitter:title" content="声音疗愈 SoundFlows | 免费在线冥想音乐、雨声白噪音、助眠放松音效">
    <meta name="twitter:description" content="SoundFlows 声音疗愈平台提供213+免费音频：雨声助眠、白噪音专注、冥想音乐、脉轮疗愈、焦虑缓解。">
    <meta name="twitter:image" content="https://www.soundflows.app/assets/images/twitter-card.jpg">
    <meta name="twitter:image:alt" content="SoundFlows 声音疗愈 - 免费雨声白噪音助眠音乐">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="../android-chrome-192x192.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Theme Color -->
    <meta name="theme-color" content="#6666ff">
    <meta name="msapplication-TileColor" content="#6666ff">

    <!-- Preconnect to External Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- �?Archive.org CDN预连�?- 优化音频/视频加载速度 -->
    <link rel="preconnect" href="https://media.soundflows.app">
    <link rel="dns-prefetch" href="https://media.soundflows.app">

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5KF3894B');</script>
    <!-- End Google Tag Manager -->

    <!-- Google Analytics 4 (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4NZR3HR3J1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      // 配置GA4测量ID
      gtag('config', 'G-4NZR3HR3J1', {
        'send_page_view': true,
        'anonymize_ip': true,
        'cookie_flags': 'SameSite=None;Secure'
      });

      // 自定义事件追�?- 音频播放
      window.trackAudioPlay = function(category, trackName) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'audio_play', {
            'event_category': 'Audio',
            'event_label': category + ' - ' + trackName,
            'audio_category': category,
            'track_name': trackName
          });
        }
      };

      // 自定义事件追�?- 语言切换
      window.trackLanguageChange = function(language) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'language_change', {
            'event_category': 'Engagement',
            'event_label': language
          });
        }
      };

      // 自定义事件追踪 - 睡眠定时器
      window.trackSleepTimer = function(minutes) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'sleep_timer_set', {
            'event_category': 'Feature',
            'event_label': minutes + ' minutes',
            'timer_duration': minutes
          });
        }
      };

      // 自定义事件追踪 - 分享点击
      window.trackShare = function(platform) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'share', {
            'event_category': 'Social',
            'event_label': platform,
            'method': platform
          });
        }
      };
    </script>

    <!-- Preload Critical Resources -->
    <link rel="preload" href="../assets/css/index-styles.css?v=20251115-modal" as="style">
    <link rel="preload" href="../assets/js/audio-config.js" as="script">
    <link rel="preload" href="../assets/js/i18n-system.js" as="script">
    <link rel="preload" href="../assets/js/index-app.js" as="script">
  
    <!-- External Stylesheets -->
    <link rel="stylesheet" href="../assets/css/global-theme.css">
    <link rel="stylesheet" href="../assets/css/index-styles.css?v=20251115-modal">
    <link rel="stylesheet" href="../assets/css/history-favorites.css">
    <link rel="stylesheet" href="../assets/css/mixer.css">
    <link rel="stylesheet" href="../assets/css/stats-dashboard.css">
    <link rel="stylesheet" href="../assets/css/accessibility.css">
    <link rel="stylesheet" href="../assets/css/notification-preferences.css">
    <link rel="stylesheet" href="../assets/css/color-contrast-fixes.css">

    <!-- 移动端优化CSS -->
    <link rel="stylesheet" href="../assets/css/mobile-optimized.css">
    <link rel="stylesheet" href="../assets/css/mobile-enhancement.css">
    <link rel="stylesheet" href="../assets/css/touch-target-optimization.css">

    <!-- 主题系统CSS -->
    <link rel="stylesheet" href="../assets/css/theme-system.css">

    <link rel="stylesheet" href="../assets/css/focus-mode.css">
    
    <!-- UI Redesign v2.0 CSS -->
    <link rel="stylesheet" href="../assets/css/redesign-v2.css">

    <!-- Audio Card Redesign - Recommended Design (Frosted Glass + Gradient Border) -->
    <link rel="stylesheet" href="../assets/css/audio-card-redesign.css">

    <!-- Category Shortcuts Redesign - Navigation Cards (Frosted Glass + Gradient Border) -->
    <link rel="stylesheet" href="../assets/css/category-shortcuts-redesign.css">

    <!-- Fix Player Position Bug - Prevents audio player from being misplaced -->
    <link rel="stylesheet" href="../assets/css/fix-player-position.css">

    <!-- Fix Scrollbar Issues - Prevent nested scrollbars -->
    <link rel="stylesheet" href="../assets/css/fix-scrollbar.css">

    <!-- Analytics Configuration (Load before analytics.js) -->
    <script src="../assets/js/analytics-config.js"></script>

    <!-- Amplitude Web SDK with Autocapture -->
    <script src="https://cdn.amplitude.com/script/b6c4ebe3ec4d16c8f5fd258d29653cfc.js"></script>
    <script>
        (function initAmplitudeSafely() {
            try {
                var amplitude = window.amplitude;

                if (!amplitude || typeof amplitude.init !== 'function') {
                    console.warn('Amplitude SDK 未就绪，跳过初始化');
                    return;
                }

                if (typeof amplitude.add === 'function' &&
                    window.sessionReplay &&
                    typeof window.sessionReplay.plugin === 'function') {
                    amplitude.add(window.sessionReplay.plugin({ sampleRate: 1 }));
                }

                amplitude.init('b6c4ebe3ec4d16c8f5fd258d29653cfc', {
                    "fetchRemoteConfig": true,
                    "autocapture": {
                        "attribution": true,
                        "fileDownloads": true,
                        "formInteractions": true,
                        "pageViews": true,
                        "sessions": true,
                        "elementInteractions": true,
                        "networkTracking": true,
                        "webVitals": true,
                        "frustrationInteractions": true
                    }
                });
            } catch (error) {
                console.warn('Amplitude 初始化失败:', error);
            }
        })();
    </script>

    <!-- Schema.org FAQPage Markup for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "How do I use white noise and rain sounds to fall asleep faster?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Choose gentle rain or white noise from our sleep sounds collection, set volume to 50-60% (loud enough to mask disruptions but not distracting), and optionally use the sleep timer for 30-60 minutes. The consistent background noise masks sudden environmental sounds that can prevent sleep onset, helping you fall asleep 38% faster according to sleep research studies. Use the same sound nightly to build a Pavlovian sleep association."
          }
        },
        {
          "@type": "Question",
          "name": "What's the best meditation music for focus and concentration?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "For deep focus work, use binaural beats in the alpha range (8-13Hz) with headphones, or ambient instrumental music without lyrics. For meditation practice, try guided meditations if you're a beginner, or Tibetan singing bowls for experienced meditators. Keep volume low (30-50%) so the music supports but doesn't dominate your attention. Studies show properly selected focus music can improve task performance by 15-20%."
          }
        },
        {
          "@type": "Question",
          "name": "Can calming sounds really reduce anxiety and stress?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes! Research shows that ocean waves, gentle rain, and slow ambient music activate your parasympathetic nervous system (your body's calm down mechanism), reducing cortisol (stress hormone) by up to 45%. Effects typically begin within 3-5 minutes as breathing naturally slows, with measurable stress reduction around 10-15 minutes. For panic attacks, focus on slow breathing (4 seconds in, 6 seconds out) while listening to calm ocean waves or rain. Daily practice builds a calm reserve that lowers baseline anxiety over time."
          }
        },
        {
          "@type": "Question",
          "name": "Do healing frequencies like 432Hz and 528Hz actually work?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "The scientific evidence on specific healing frequencies like 432Hz and 528Hz is mixed and still emerging. Some studies suggest 432Hz music may reduce stress more than standard 440Hz tuning, while 528Hz has been studied for potential cellular benefits (though findings are preliminary). What's scientifically clear: the combination of relaxed listening, focused intention, and regular practice creates measurable physiological benefits regardless of exact frequency. If a sound helps you meditate, relax, or focus healing intention, it's working through proven mind-body mechanisms."
          }
        },
        {
          "@type": "Question",
          "name": "Is SoundFlows really free? Do I need to download an app?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, SoundFlows is 100% free with no hidden costs, no credit card required, and no app download needed. All 213+ healing sounds work directly in your web browser on any device (phone, tablet, computer). We offer optional account creation to save your favorites and track progress, but you can use all features as a guest. Our mission is making evidence-based sound therapy accessible to everyone, not maximizing profits."
          }
        },
        {
          "@type": "Question",
          "name": "How long should I listen to sound healing tracks?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "For sleep: 30-60 minutes, or all night if environmental noise is constant. For meditation: Start with 10-15 minutes, work up to 20-30 minutes as your practice deepens. For anxiety relief: 10-20 minutes during acute stress; daily 10-minute sessions for prevention. For focus work: 25-50 minute blocks (Pomodoro-style) with 5-10 minute breaks. For chakra healing: 10-20 minutes per chakra, or 5-10 minutes each for a full 7-chakra session. Consistency matters more than duration — daily 10-minute practice beats occasional hour-long sessions."
          }
        }
      ]
    }
    </script>

    <!-- Force Chinese Language for /zh/ Path -->
    <script>
        // Override language detection for Chinese version
        localStorage.setItem('sound_healing_language', 'zh-CN');

        // Ensure i18n system uses Chinese on initialization
        window.addEventListener('DOMContentLoaded', function() {
            if (window.i18n && typeof window.i18n.changeLanguage === 'function') {
                window.i18n.changeLanguage('zh-CN');
            }
        });
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5KF3894B"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- SEO H1 (Hidden for SEO purposes, screen reader accessible) -->
    <h1 style="position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden;">
        Sleep Better with SoundFlows: Free Rain Sounds, White Noise & Meditation Music for Sleep, Focus & Anxiety Relief
    </h1>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text">
            <span data-i18n="loading.text"></span><br>
            <small data-i18n="loading.subtext"></small>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app">
        <!-- Background Canvas -->
        <canvas id="backgroundCanvas"></canvas>

        <!-- Header -->
                <div class="saas-shell">
            <header class="saas-hero" role="banner" id="heroIntro">
                <nav class="saas-nav" aria-label="主导航">
                    <div class="saas-nav__brand">
                        <span class="saas-nav__logo" aria-hidden="true">🎧</span>
                        <div>
                            <p class="saas-nav__title" data-i18n="app.title"></p>
                            <p class="saas-nav__subtitle" data-i18n="header.tagline"></p>
                        </div>
                    </div>
                    <ul class="saas-nav__links">
                        <li><a href="#experienceLaunchpad" data-i18n="nav.quick.start">立即体验</a></li>
                        <li><a href="#categoryGrid" data-i18n="nav.quick.categories">浏览全部分类</a></li>
                        <li><a href="#impactProof" data-i18n="nav.quick.metrics">疗愈成效</a></li>
                        <li><a href="#contentHub" data-i18n="nav.resources">内容资源</a></li>
                    </ul>
                    <div class="saas-nav__actions">
                        <span class="saas-nav__pill" data-i18n="nav.badge.new"></span>
                        <button class="saas-nav__ghost" type="button" id="navHistoryBtn" aria-label="Play History" onclick="window.historyFavoritesUI?.openPanel('history')">
                            <span aria-hidden="true">🕘</span>
                            <span data-i18n="nav.history"></span>
                        </button>
                        <button class="saas-nav__ghost" type="button" id="navFavoritesBtn" aria-label="My Favorites" onclick="window.historyFavoritesUI?.openPanel('favorites')">
                            <span aria-hidden="true">⭐</span>
                            <span data-i18n="nav.favorites"></span>
                        </button>
                        <div class="language-selector" id="languageSelector">
                            <button class="language-toggle" id="languageToggle" type="button" aria-haspopup="listbox" aria-expanded="false" aria-label="Select language">
                                <span class="language-toggle__label" data-role="language-label">EN</span>
                                <span class="language-toggle__icon" aria-hidden="true">🌐</span>
                            </button>
                            <div class="language-dropdown" id="languageDropdown" role="listbox" aria-label="Select Language">
                                <button class="language-option" type="button" data-lang="en-US" data-url="/en/" role="option" aria-selected="true">
                                    <span>English</span>
                                </button>
                                <button class="language-option" type="button" data-lang="zh-CN" data-url="/zh/" role="option" aria-selected="false">
                                    <span>简体中文</span>
                                </button>
                                <button class="language-option" type="button" data-lang="ja-JP" role="option" aria-selected="false">
                                    <span>日本語</span>
                                </button>
                                <button class="language-option" type="button" data-lang="ko-KR" role="option" aria-selected="false">
                                    <span>한국어</span>
                                </button>
                                <button class="language-option" type="button" data-lang="es-ES" role="option" aria-selected="false">
                                    <span>Español</span>
                                </button>
                            </div>
                        </div>
                        <button class="saas-nav__signin" type="button" data-i18n="nav.signin"></button>
                    </div>
                </nav>
                <div class="saas-category-shortcuts" id="categoryShortcuts" aria-label="音频类型快捷导航" role="list"></div>
                <div class="saas-hero__grid">
                                        <div class="saas-hero__content">
                        <p class="saas-hero__eyebrow" data-i18n="hero.eyebrow">今晚放慢呼吸</p>
                        <h2 class="saas-hero__headline" data-i18n="hero.headline">科学验证的疗愈声景，帮你更快入睡</h2>
                        <p class="saas-hero__description" data-i18n="hero.description">213+ 雨声、白噪音与冥想音乐，设计用于深度睡眠、平稳专注与温柔清晨。</p>
                        <div class="saas-hero__cta">
                            <button class="saas-btn saas-btn--primary" data-cta="start-experience" data-action="start-default-session" aria-label="Start sleep session">
                                <span data-i18n="hero.cta.primary">开启 15 分钟助眠雨声</span>
                            </button>
                            <button class="saas-btn saas-btn--ghost" data-scroll-target="#conversionOffer" data-track="plan-open">
                                <span data-i18n="hero.cta.plan">领取 7 天免费练习计划</span>
                            </button>
                        </div>
                    </div>
                    <div class="saas-hero__panel">
                        <div class="saas-panel__badge" data-i18n="hero.panel.badge">120K+ 用户夜间仪式</div>
                        <p class="saas-panel__copy" data-i18n="hero.panel.copy">打开浏览器即可安静播放，无需登录或安装，随时进入疗愈流程。</p>
                        <div class="saas-panel__metrics">
                            <article class="metric-card">
                                <p class="metric-card__number">213+</p>
                                <p class="metric-card__title" data-i18n="hero.metrics.soundscapes">疗愈声景</p>
                                <p class="metric-card__desc" data-i18n="hero.metrics.soundscapes.desc">雨声、白噪音、颂钵与呼吸引导。</p>
                            </article>
                            <article class="metric-card">
                                <p class="metric-card__number">9</p>
                                <p class="metric-card__title" data-i18n="hero.metrics.languages">多语言支持</p>
                                <p class="metric-card__desc" data-i18n="hero.metrics.languages.desc">English / 中文 / 日本語 / 한국어 / Español</p>
                            </article>
                            <article class="metric-card">
                                <p class="metric-card__number">120K+</p>
                                <p class="metric-card__title" data-i18n="hero.metrics.sessions">引导练习完成数</p>
                                <p class="metric-card__desc" data-i18n="hero.metrics.sessions.desc">睡眠记录｜专注仪式｜正念清晨。</p>
                            </article>
                            <article class="metric-card metric-card--journeys">
                                <p class="metric-card__title" data-i18n="hero.metrics.journeys">5 大核心旅程</p>
                                <ul>
                                    <li data-i18n="hero.metrics.journeys.sleep">睡眠</li>
                                    <li data-i18n="hero.metrics.journeys.focus">专注</li>
                                    <li data-i18n="hero.metrics.journeys.anxiety">缓压</li>
                                    <li data-i18n="hero.metrics.journeys.emotion">情绪</li>
                                    <li data-i18n="hero.metrics.journeys.chakra">脉轮</li>
                                </ul>
                            </article>
                        </div>
                        <div class="saas-panel__footer">
                            <p data-i18n="hero.panel.footer">基于 120K+ 匿名睡眠与专注数据验证</p>
                            <a href="#impactProof" aria-label="See data" data-i18n="hero.panel.link">查看数据 →</a>
                        </div>
                    </div>
                </div>
            </header>
        </div>

        <section class="experience-launchpad" id="experienceLaunchpad" aria-label="即时播放控制台">
            <div class="experience-launchpad__grid">
                <div class="experience-launchpad__player-card">
                    <div class="player-modal-prompt">
                        <p class="player-modal-prompt__eyebrow">����������</p>
                        <h3>���ſ��ƻ����㰴�²���ʱ�Զ�����</h3>
                        <p>ѡ��������Ƶ�������������ᵯ�����������������ϴ�ơ���ʱ�����ã������뿪��ǰҳ�档</p>
                        <div class="player-modal-prompt__actions">
                            <button class="saas-btn saas-btn--primary" type="button" onclick="window.openPlayerModal(true)">�����򿪲�����</button>
                            <button class="saas-btn saas-btn--ghost" type="button" onclick="openPlaylist('Rain', AUDIO_CONFIG.categories['Rain'])" data-i18n="player.exploreMore">���������Ƶ</button>
                        </div>
                        <p class="player-modal-prompt__hint">ÿ���㿪ʼ������Ƶ�������������Զ�������</p>
                    </div>
                </div>
                <div class="experience-launchpad__insights">
                    <article class="insight-card">
                        <p class="insight-card__label">个性流程</p>
                        <h4>选择状态，系统即刻推送最佳声音组合。</h4>
                        <ul>
                            <li>场景感知雾化灯效</li>
                            <li>跨设备同步播放队列</li>
                            <li>自动睡眠定时与唤醒</li>
                        </ul>
                    </article>
                    <article class="insight-card">
                        <p class="insight-card__label">团队支持</p>
                        <h4>专属音疗顾问在线协助，输出周报与使用洞察。</h4>
                        <a href="#conversionOffer">预约顾问 →</a>
                    </article>
                </div>
            </div>
        </section>
<section class="feature-summary" id="featureHighlights" role="region" aria-labelledby="featuresTitle">
                <div class="feature-summary__heading">
                    <h3 id="featuresTitle" data-i18n="features.heading.title">为什么选择声音疗愈空间？</h3>
                    <p data-i18n="features.heading.desc">我们把专业音疗体验压缩进一个浏览器，在任何设备上都能获取科学、柔和且富有仪式感的放松流程。</p>
                    <button type="button" class="feature-summary__cta" data-track="stats-open" data-cta="feature-summary" data-i18n="features.heading.cta"
                            aria-label="Learn about professional sound therapy statistics" tabindex="0">了解专业音疗统计</button>
                </div>
                <div class="feature-summary__grid">
                    <article class="feature-card">
                        <h4 data-i18n="features.card1.title">沉浸场景秒匹配</h4>
                        <p data-i18n="features.card1.desc">根据分类智能切换视频背景与氛围动画，自然进入与情绪相匹配的疗愈空间。</p>
                    </article>
                    <article class="feature-card">
                        <h4 data-i18n="features.card2.title">个性混音与收藏</h4>
                        <p data-i18n="features.card2.desc">混合雨声、白噪、颂钵等元素，保存个人配方并跨设备同步历史记录。</p>
                    </article>
                    <article class="feature-card">
                        <h4 data-i18n="features.card3.title">专注模式与睡眠定时</h4>
                        <p data-i18n="features.card3.desc">全屏专注视图与智能睡眠定时器，让冥想、午休与夜间睡眠都更轻松。</p>
                    </article>
                    <article class="feature-card">
                        <h4 data-i18n="features.card4.title">数据可视化洞察</h4>
                        <p data-i18n="features.card4.desc">内置统计面板记录播放频率、时长与偏好，帮助你建立持续的自我照护节奏。</p>
                    </article>
                </div>
            </section>

            <section class="journey-showcase" id="journeyShowcase">
                <div class="journey-showcase__heading">
                    <h3 data-i18n="journey.heading.title">选择与你状态匹配的疗愈旅程</h3>
                    <p data-i18n="journey.heading.desc">按目标切换专属声景，立即开始更聚焦的冥想、睡眠或情绪舒缓流程。</p>
                </div>
                <div class="journey-showcase__grid">
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.meditation.label">冥想专注</div>
                        <h4 data-i18n="journey.meditation.title">晨间冥想 & 日常正念</h4>
                        <p data-i18n="journey.meditation.desc">精选颂钵与呼吸声景，配合轻引导帮助你在 10 分钟内回到觉察与平静。</p>
                        <a class="journey-card__cta" href="#meditation" onclick="document.getElementById('categoryGrid').scrollIntoView({behavior: 'smooth'})" data-i18n="journey.meditation.cta">进入冥想旅程 →</a>
                    </article>
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.sleep.label">深度睡眠</div>
                        <h4 data-i18n="journey.sleep.title">夜间放松 & 快速入睡</h4>
                        <p data-i18n="journey.sleep.desc">组合雨声、白噪与定时器，温柔覆盖夜晚每个阶段，让思绪慢慢沉静。</p>
                        <a class="journey-card__cta" href="#rain-sounds" onclick="document.getElementById('categoryGrid').scrollIntoView({behavior: 'smooth'})" data-i18n="journey.sleep.cta">打开心流睡眠 →</a>
                    </article>
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.balance.label">能量平衡</div>
                        <h4 data-i18n="journey.balance.title">脉轮疗愈 & 气场净化</h4>
                        <p data-i18n="journey.balance.desc">七大脉轮共振与水晶音浴，帮助身体与情绪重新找回内部秩序。</p>
                        <a class="journey-card__cta" href="#chakra-healing" onclick="document.getElementById('categoryGrid').scrollIntoView({behavior: 'smooth'})" data-i18n="journey.balance.cta">感受能量复位 →</a>
                    </article>
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.emotion.label">情绪疗愈</div>
                        <h4 data-i18n="journey.emotion.title">释放焦虑与压力</h4>
                        <p data-i18n="journey.emotion.desc">潜意识疗愈与引导式放松，陪你走过日常压力、告别负面循环。</p>
                        <a class="journey-card__cta" href="#subconscious-therapy" onclick="document.getElementById('categoryGrid').scrollIntoView({behavior: 'smooth'})" data-i18n="journey.emotion.cta">开始情绪舒缓 →</a>
                    </article>
                </div>
            </section>

            <section class="conversion-offer" id="conversionOffer">
                <div class="conversion-offer__content">
                    <h3 data-i18n="form.plan.title">领取你的 7 日定制冥想计划</h3>
                    <p data-i18n="form.plan.description">告诉我们你当前的状态，我们会组合合适的声景、冥想练习与睡眠建议，发送一份结构化的 7 日音疗安排。</p>
                    <ul>
                        <li data-i18n="form.plan.benefit1">每日 2 份推荐音频与练习提示</li>
                        <li data-i18n="form.plan.benefit2">结合睡眠或专注目标的提醒计划</li>
                        <li data-i18n="form.plan.benefit3">个性化混音建议与进度跟踪指引</li>
                    </ul>
                </div>
                <div class="conversion-offer__form">
                    <p class="plan-trust" data-i18n="form.plan.trust">基于 120K+ 匿名练习生成，随时可取消。</p>
                    <form id="planRequestForm" novalidate>
                        <div class="conversion-offer__field">
                            <label for="planName" data-i18n="form.plan.label.name">你的昵称</label>
                            <input id="planName" name="name" type="text" data-i18n-placeholder="form.plan.placeholder.name" placeholder="如：小觉" required>
                        </div>
                        <div class="conversion-offer__field">
                            <label for="planEmail" data-i18n="form.plan.label.email">联系邮箱</label>
                            <input id="planEmail" name="email" type="email" data-i18n-placeholder="form.plan.placeholder.email" placeholder="your@email.com" required>
                        </div>
                        <div class="conversion-offer__field">
                            <label for="planGoal" data-i18n="form.plan.label.goal">当前最想改善的目标</label>
                            <select id="planGoal" name="goal" required>
                                <option value="" data-i18n="form.plan.goal.select">请选择</option>
                                <option value="sleep" data-i18n="form.plan.goal.sleep">提升睡眠质量</option>
                                <option value="focus" data-i18n="form.plan.goal.focus">提升专注效率</option>
                                <option value="stress" data-i18n="form.plan.goal.stress">缓解焦虑与压力</option>
                                <option value="mindfulness" data-i18n="form.plan.goal.mindfulness">建立规律冥想习惯</option>
                            </select>
                        </div>
                        <div class="conversion-offer__field">
                            <label for="planTime" data-i18n="form.plan.label.time">每日可投入的时长</label>
                            <select id="planTime" name="time" required>
                                <option value="" data-i18n="form.plan.time.select">请选择</option>
                                <option value="5-10" data-i18n="form.plan.time.5-10">5-10 分钟</option>
                                <option value="10-20" data-i18n="form.plan.time.10-20">10-20 分钟</option>
                                <option value="20-30" data-i18n="form.plan.time.20-30">20-30 分钟</option>
                                <option value="30+" data-i18n="form.plan.time.30+">30 分钟以上</option>
                            </select>
                        </div>
                        <button type="submit" class="conversion-offer__submit" data-track="plan-submit" data-i18n="form.plan.submit">领取定制计划</button>
                    </form>
                    <div class="conversion-offer__success" aria-live="polite" data-i18n="form.plan.success">
                        ✅ 计划申请成功！我们会在 5 分钟内将定制冥想安排发送至你的邮箱，请注意查收。
                    </div>
                </div>
            </section>

            <!-- Category Section -->
            <section class="content-hub" id="contentHub">
                <div class="content-hub__intro">
                    <h3 data-i18n="content.heading.title">疗愈知识库 · 每天 10 分钟提升身心觉察</h3>
                    <p data-i18n="content.heading.desc">精选文章、实践指南与短视频，结合音疗技巧与真实案例，让"听"与"做"更有结构。</p>
                    <a class="content-hub__cta" href="#contentHub" data-i18n="content.heading.cta">访问全部内容 →</a>
                </div>
                <div class="content-hub__grid">
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card1.tag">指南</div>
                        <h4 data-i18n="content.card1.title">30 分钟睡前音疗步骤</h4>
                        <p data-i18n="content.card1.desc">按照"缓和呼吸 → 白噪预热 → 深度冥想"的三段结构，快速进入深层睡眠。</p>
                        <a class="content-card__link" href="resources-detail.html?id=sleep-guide" data-i18n="content.card1.link">阅读指南 →</a>
                    </article>
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card2.tag">视频</div>
                        <h4 data-i18n="content.card2.title">雨声 + 颂钵混音实操</h4>
                        <p data-i18n="content.card2.desc">1 分钟学会在混音台里叠加雨声与颂钵，让午后专注更稳定。</p>
                        <button class="content-card__link" onclick="window.mixerUI && window.mixerUI.open()" data-i18n="content.card2.link">即刻观看 →</button>
                    </article>
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card3.tag">案例</div>
                        <h4 data-i18n="content.card3.title">设计师小安的晨间冥想</h4>
                        <p data-i18n="content.card3.desc">看看她如何用 7 日音疗计划缓解焦虑，并保持每周 5 次冥想的习惯。</p>
                        <a class="content-card__link" href="resources-detail.html?id=meditation-guide" data-i18n="content.card3.link">查看故事 →</a>
                    </article>
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card4.tag">音疗笔记</div>
                        <h4 data-i18n="content.card4.title">脉轮共振与情绪释放</h4>
                        <p data-i18n="content.card4.desc">从颜色、频率到身体对应部位，了解脉轮疗愈的科学基础与入门练习。</p>
                        <a class="content-card__link" href="resources-detail.html?id=healing-guide" data-i18n="content.card4.link">下载笔记 →</a>
                    </article>
                </div>
            </section>

            <section class="impact-proof" id="impactProof">
                <div class="impact-proof__grid">
                    <article class="impact-card impact-card--stats">
                        <h4 data-i18n="impact.stats.title">38% 用户完成 7 日引导疗程</h4>
                        <p data-i18n="impact.stats.desc">基于 2025 年匿名数据，持续使用混音 + 冥想方案的用户中，有 38% 成功完成我们推荐的深度疗愈课程。</p>
                        <button type="button" class="impact-card__cta" data-track="stats-open" data-cta="impact-stats" data-i18n="impact.stats.cta">查看详细数据面板</button>
                    </article>
                    <article class="impact-card impact-card--story">
                        <h4 data-i18n="impact.story.title">用户故事 · 设计师小安的转变</h4>
                        <p data-i18n="impact.story.desc">通过 7 日音疗计划，她将晨间焦虑指数降低 45%，并把 15 分钟冥想融入日常通勤前的仪式。</p>
                        <a class="impact-card__link" href="#conversionOffer" data-i18n="impact.story.link">阅读完整故事 →</a>
                    </article>
                </div>
            </section>

            <section class="personalized-recommendations" id="personalizedRecommendations" aria-label="个性化声音推荐">
                <div class="recommendations__header">
                    <div>
                        <p class="recommendations__eyebrow" data-i18n="recommendations.eyebrow">为你精挑细选</p>
                        <h3 data-i18n="recommendations.title">基于行为和时间段的疗愈清单</h3>
                        <p class="recommendations__description" data-i18n="recommendations.body">
                            我们会结合你的最近播放、收藏偏好以及当前时间段，为你生成 6 条最契合的疗愈音频。
                        </p>
                    </div>
                    <button class="recommendations__refresh" type="button" id="refreshRecommendationsBtn" aria-live="polite">
                        <span aria-hidden="true">↻</span>
                        <span data-i18n="recommendations.refresh">刷新推荐</span>
                    </button>
                </div>
                <div class="recommendations__grid" id="recommendationsGrid" role="list" aria-live="polite">
                    <div class="recommendations__skeleton" aria-hidden="true"></div>
                    <div class="recommendations__skeleton" aria-hidden="true"></div>
                    <div class="recommendations__skeleton" aria-hidden="true"></div>
                </div>
            </section>

            <!-- 分类网格已移除 - 现在使用导航下的快捷卡片直接播放 -->
        </div>

        <!-- Playlist Modal -->
        <div id="playlistModal" class="playlist-modal" style="display: none;" role="dialog" aria-labelledby="playlistTitle" aria-modal="true">
            <div class="modal-content">
                <button class="close" onclick="closePlaylist()" data-i18n="modal.close" aria-label="关闭播放列表" tabindex="0">&times;</button>
                <h2 id="playlistTitle" data-i18n="playlist.title">选择音频</h2>
                <div id="trackList" class="track-list" role="list" aria-label="Audio tracks"></div>
            </div>
        </div>

        <!-- 弹窗式播放器 - 默认隐藏，播放时显示 -->
        <div id="playerModal" class="player-modal" role="dialog" aria-labelledby="playerModalTitle" aria-hidden="true">
            <!-- 背景遮罩 - 不自动关闭，让用户控制 -->
            <div class="player-modal-overlay"></div>

            <!-- 播放器主体 -->
            <div class="player-modal-content">
                <div id="audioPlayer" class="audio-player" role="region" aria-label="音频播放控制">
                    <!-- 关闭按钮 -->
                    <button class="player-close-btn" onclick="closePlayer()" aria-label="关闭播放器">×</button>

                    <!-- 第1行：6个控制按钮 -->
                    <div class="player-controls-row" role="group" aria-label="播放控制">
                        <button class="control-btn" id="repeatBtn" onclick="toggleRepeat()" aria-pressed="false" aria-label="循环模式">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 1l4 4-4 4"/>
                                <path d="M3 11V9a4 4 0 0 1 4-4h14"/>
                                <path d="M7 23l-4-4 4-4"/>
                                <path d="M21 13v2a4 4 0 0 1-4 4H3"/>
                            </svg>
                        </button>
                        <button class="control-btn" onclick="previousTrack()" aria-label="上一首">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="19 20 9 12 19 4 19 20"/>
                                <line x1="5" y1="19" x2="5" y2="5"/>
                            </svg>
                        </button>
                        <button id="playPauseBtn" class="control-btn play-btn" onclick="togglePlayPause()" aria-label="播放或暂停">
                            <svg class="play-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <polygon points="5 3 19 12 5 21 5 3"/>
                            </svg>
                            <svg class="pause-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="display:none;">
                                <rect x="6" y="4" width="4" height="16"/>
                                <rect x="14" y="4" width="4" height="16"/>
                            </svg>
                        </button>
                        <button class="control-btn" onclick="nextTrack()" aria-label="下一首">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="5 4 15 12 5 20 5 4"/>
                                <line x1="19" y1="5" x2="19" y2="19"/>
                            </svg>
                        </button>
                        <button class="control-btn" id="shuffleBtn" onclick="toggleShuffle()" aria-pressed="false" aria-label="随机播放">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="16 3 21 3 21 8"/>
                                <line x1="4" y1="20" x2="21" y2="3"/>
                                <polyline points="21 16 21 21 16 21"/>
                                <line x1="15" y1="15" x2="21" y2="21"/>
                                <line x1="4" y1="4" x2="9" y2="9"/>
                            </svg>
                        </button>
                        <button class="control-btn" id="sleepTimerBtn" onclick="toggleSleepTimer()" aria-label="睡眠定时">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <polyline points="12 6 12 12 16 14"/>
                            </svg>
                        </button>
                    </div>

                    <!-- 第2行：进度条 + 时间 -->
                    <div class="player-progress-row" role="group" aria-label="播放进度">
                        <div class="progress-bar" onclick="seekTo(event)" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                            <div id="progressFill" class="progress-fill"></div>
                        </div>
                        <span id="currentTime" class="time-display">0:00</span>
                    </div>

                    <!-- 第3行：音量控制 -->
                    <div class="player-volume-row" role="group" aria-label="音量控制">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="flex-shrink:0;opacity:0.7;">
                            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"/>
                        </svg>
                        <div class="volume-control" id="volumeControl">
                            <div class="volume-fill" id="volumeFill"></div>
                            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70" aria-label="音量">
                        </div>
                    </div>
                </div>
            </div>
        </div>
<!-- Skip to main content link for screen readers -->
        <a href="#mainContent" class="skip-link">跳到主要内容</a>

        <!-- Live region for screen reader announcements -->
        <div id="ariaLiveRegion" class="sr-only" aria-live="polite" aria-atomic="true"></div>
        <div id="ariaAlertRegion" class="sr-only" aria-live="assertive" aria-atomic="true"></div>

        <!-- Onboarding Tutorial -->
        <div id="onboardingTutorial" class="onboarding-tutorial" aria-hidden="true">
            <div class="tutorial-overlay" aria-hidden="true"></div>
            <div class="tutorial-dialog" role="dialog" aria-modal="true" aria-labelledby="tutorialTitle">
                <header class="tutorial-header">
                    <p class="tutorial-label" data-i18n="tutorial.label">新手引导</p>
                    <h3 id="tutorialTitle" data-i18n="tutorial.title">3 分钟熟悉声音疗愈</h3>
                    <button class="tutorial-close tutorial-btn" data-action="skip" aria-label="跳过教程">×</button>
                </header>
                <ol class="tutorial-steps">
                    <li class="tutorial-step active" data-step="1">
                        <h4 data-i18n="tutorial.step1.title">选择当下目标</h4>
                        <p data-i18n="tutorial.step1.desc">浏览顶部的快捷入口，告诉我们你想睡眠、专注还是舒缓压力。</p>
                    </li>
                    <li class="tutorial-step" data-step="2">
                        <h4 data-i18n="tutorial.step2.title">探索 200+ 分类</h4>
                        <p data-i18n="tutorial.step2.desc">点击任一分类卡片即可开启播放列表，还能看到多语言描述。</p>
                    </li>
                    <li class="tutorial-step" data-step="3">
                        <h4 data-i18n="tutorial.step3.title">掌控播放器</h4>
                        <p data-i18n="tutorial.step3.desc">音量、睡眠定时、收藏都在底部播放器，键盘同样可操作。</p>
                    </li>
                    <li class="tutorial-step" data-step="4">
                        <h4 data-i18n="tutorial.step4.title">领取个性推荐</h4>
                        <p data-i18n="tutorial.step4.desc">完成一个音轨即可解锁推荐区，记录会同步到历史与收藏。</p>
                    </li>
                </ol>
                <div class="tutorial-progress" role="tablist" aria-label="教程进度">
                    <button class="progress-dot active" data-step="1" aria-label="教程第 1 步"></button>
                    <button class="progress-dot" data-step="2" aria-label="教程第 2 步"></button>
                    <button class="progress-dot" data-step="3" aria-label="教程第 3 步"></button>
                    <button class="progress-dot" data-step="4" aria-label="教程第 4 步"></button>
                </div>
                <div class="tutorial-actions">
                    <button class="tutorial-btn tutorial-btn--ghost" data-action="prev" aria-label="上一步" type="button">
                        <span data-i18n="tutorial.prev">上一步</span>
                    </button>
                    <button class="tutorial-btn tutorial-btn--primary" data-action="next" aria-label="下一步" type="button">
                        <span data-i18n="tutorial.next">下一步</span>
                    </button>
                    <button class="tutorial-btn tutorial-btn--primary" data-action="start" aria-label="开始体验" type="button" style="display: none;">
                        <span data-i18n="tutorial.start">立即开始</span>
                    </button>
                </div>
            </div>
        </div>
        <div id="tutorialHighlight" class="tutorial-highlight" aria-hidden="true"></div>
        <button id="tutorialHelpBtn" class="tutorial-help-btn" type="button" aria-haspopup="dialog" aria-controls="onboardingTutorial">
            <span aria-hidden="true">❔</span>
            <span data-i18n="tutorial.help">需要引导</span>
        </button>

        <!-- User Rating Widget -->
        <div id="rating-widget"></div>

        <!-- Compact Login Modal -->
        <div id="compactLoginModal" class="compact-login-modal" style="display: none;" role="dialog" aria-labelledby="compactLoginTitle" aria-modal="true">
            <div class="compact-modal-overlay" onclick="closeCompactLogin()"></div>
            <div class="compact-modal-content">
                <div class="compact-modal-header">
                    <h3 id="compactLoginTitle" data-i18n="auth.welcome">欢迎回来</h3>
                    <button class="compact-modal-close" onclick="closeCompactLogin()" aria-label="关闭登录窗口">&times;</button>
                </div>
                <p class="compact-login-hint" data-i18n="auth.guestHint">以访客身份即可体验大部分功能，稍后随时绑定邮箱。</p>

                <!-- Email Login Form -->
                <div id="emailLoginForm" class="compact-login-form">
                    <div class="form-group">
                        <input type="email" id="compactEmail" placeholder="邮箱地址" autocomplete="email" tabindex="0">
                    </div>
                    <div class="form-group">
                        <input type="password" id="compactPassword" placeholder="密码" autocomplete="current-password" tabindex="0">
                    </div>
                    <button class="compact-login-btn primary" onclick="handleCompactLogin()" tabindex="0">登录</button>
                    <div class="compact-login-options">
                        <button class="compact-link" onclick="showCompactSignup()">还没有账号？注册</button>
                        <button class="compact-link" onclick="showCompactReset()">忘记密码？</button>
                    </div>
                </div>

                <!-- Email Signup Form -->
                <div id="emailSignupForm" class="compact-login-form" style="display: none;">
                    <div class="form-group">
                        <input type="text" id="compactName" placeholder="昵称" autocomplete="name" tabindex="0">
                    </div>
                    <div class="form-group">
                        <input type="email" id="compactSignupEmail" placeholder="邮箱地址" autocomplete="email" tabindex="0">
                    </div>
                    <div class="form-group">
                        <input type="password" id="compactSignupPassword" placeholder="密码 (至少6位)" autocomplete="new-password" tabindex="0" minlength="6">
                    </div>
                    <button class="compact-login-btn primary" onclick="handleCompactSignup()" tabindex="0">注册</button>
                    <div class="compact-login-options">
                        <button class="compact-link" onclick="showCompactLogin()">已有账号？登录</button>
                    </div>
                </div>

                <!-- Password Reset Form -->
                <div id="passwordResetForm" class="compact-login-form" style="display: none;">
                    <p data-i18n="auth.resetInstructions">输入您的邮箱地址，我们将发送重置链接</p>
                    <div class="form-group">
                        <input type="email" id="compactResetEmail" placeholder="邮箱地址" autocomplete="email" tabindex="0">
                    </div>
                    <button class="compact-login-btn primary" onclick="handleCompactReset()" tabindex="0">发送重置邮件</button>
                    <div class="compact-login-options">
                        <button class="compact-link" onclick="showCompactLogin()">返回登录</button>
                    </div>
                </div>

                <!-- Phone Login Form -->
                <div id="phoneLoginForm" class="compact-login-form" style="display: none;">
                    <div class="form-group">
                        <input type="tel" id="compactPhone" placeholder="手机号码 (+86 138 0000 0000)" autocomplete="tel" tabindex="0">
                    </div>
                    <div class="form-group phone-code-group">
                        <input type="text" id="compactVerificationCode" placeholder="验证码" autocomplete="one-time-code" tabindex="0">
                        <button class="send-code-btn" onclick="sendVerificationCode()" tabindex="0">发送验证码</button>
                    </div>
                    <button class="compact-login-btn primary" onclick="handlePhoneLogin()" tabindex="0">登录</button>
                    <div class="compact-login-options">
                        <button class="compact-link" onclick="showCompactLogin()">使用邮箱登录</button>
                    </div>
                </div>

                <div class="compact-modal-divider">
                    <span>或</span>
                </div>

                <!-- Quick Login Options -->
                <div class="compact-quick-login">
                    <button class="compact-option-btn google" onclick="handleGoogleLogin()" tabindex="0">
                        <span class="btn-icon">🔵</span>
                        Google
                    </button>
                    <button class="compact-option-btn anonymous" onclick="handleAnonymousLogin()" tabindex="0">
                        <span class="btn-icon">👤</span>
                        <span data-i18n="auth.guestCta">以访客身份继续</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- User Profile Display -->
        <div id="userProfile" class="user-profile" style="display: none;">
            <!-- 用户信息将在这里动态显示 -->
        </div>

        <!-- Notification -->
        <div id="notification" class="notification"></div>

        <!-- FAQ Section (SEO-Optimized for English Search Queries) -->
        <section style="max-width: 900px; margin: 4rem auto 4rem; padding: 0 2rem;">
            <h2 style="font-size: 2.25rem; text-align: center; margin-bottom: 2.5rem; color: var(--text-primary);">
                Frequently Asked Questions
            </h2>

            <div style="display: flex; flex-direction: column; gap: 2rem;">
                <!-- FAQ 1 -->
                <div style="background: var(--bg-card); padding: 1.75rem; border-radius: 12px; border: 1px solid var(--border-subtle);">
                    <h3 style="font-size: 1.25rem; color: var(--text-primary); margin-bottom: 0.75rem;">
                        How do I use white noise and rain sounds to fall asleep faster?
                    </h3>
                    <p style="line-height: 1.8; color: var(--text-secondary); font-size: 0.95rem;">
                        Choose gentle rain or white noise from our sleep sounds collection, set volume to 50-60% (loud enough to mask disruptions but not distracting),
                        and optionally use the sleep timer for 30-60 minutes. The consistent background noise masks sudden environmental sounds that can prevent sleep onset,
                        helping you fall asleep 38% faster according to sleep research studies. Use the same sound nightly to build a Pavlovian sleep association.
                    </p>
                </div>

                <!-- FAQ 2 -->
                <div style="background: var(--bg-card); padding: 1.75rem; border-radius: 12px; border: 1px solid var(--border-subtle);">
                    <h3 style="font-size: 1.25rem; color: var(--text-primary); margin-bottom: 0.75rem;">
                        What's the best meditation music for focus and concentration?
                    </h3>
                    <p style="line-height: 1.8; color: var(--text-secondary); font-size: 0.95rem;">
                        For deep focus work, use binaural beats in the alpha range (8-13Hz) with headphones, or ambient instrumental music without lyrics.
                        For meditation practice, try guided meditations if you're a beginner, or Tibetan singing bowls for experienced meditators.
                        Keep volume low (30-50%) so the music supports but doesn't dominate your attention. Studies show properly selected focus music can improve
                        task performance by 15-20%.
                    </p>
                </div>

                <!-- FAQ 3 -->
                <div style="background: var(--bg-card); padding: 1.75rem; border-radius: 12px; border: 1px solid var(--border-subtle);">
                    <h3 style="font-size: 1.25rem; color: var(--text-primary); margin-bottom: 0.75rem;">
                        Can calming sounds really reduce anxiety and stress?
                    </h3>
                    <p style="line-height: 1.8; color: var(--text-secondary); font-size: 0.95rem;">
                        是的！研究表明，海浪、细雨与缓慢氛围音乐能够启动副交感神经系统，让身体进入“放松模式”，皮质醇最高可下降 45%。通常聆听 3-5 分钟就会感觉呼吸放慢，10-15 分钟能显著降低压力。若有突发焦虑，可搭配 4-6 呼吸法（吸气 4 秒、呼气 6 秒）聆听海浪或雨声。每天练习会累积“平静储备”，逐渐降低基础焦虑。
                    </p>
                </div>

                <!-- FAQ 4 -->
                <div style="background: var(--bg-card); padding: 1.75rem; border-radius: 12px; border: 1px solid var(--border-subtle);">
                    <h3 style="font-size: 1.25rem; color: var(--text-primary); margin-bottom: 0.75rem;">
                        432Hz、528Hz 等“疗愈频率”真的有效吗？
                    </h3>
                    <p style="line-height: 1.8; color: var(--text-secondary); font-size: 0.95rem;">
                        目前关于 432Hz、528Hz 等特定频率的研究仍在持续，结论并不一致。有实验显示 432Hz 相比 440Hz 更能缓解压力，528Hz 也被用于细胞修复的探索（但证据仍有限）。可以确定的是：<strong>放松的聆听、专注的意图与持续练习</strong> 会带来可量化的身心益处，与具体频率并无绝对关系。只要某种声音让你冥想、放松或专注疗愈，它就通过身心机制发挥了作用。
                    </p>
                </div>

                <!-- FAQ 5 -->
                <div style="background: var(--bg-card); padding: 1.75rem; border-radius: 12px; border: 1px solid var(--border-subtle);">
                    <h3 style="font-size: 1.25rem; color: var(--text-primary); margin-bottom: 0.75rem;">
                        SoundFlows 真的是免费的吗？需要安装 App 吗？
                    </h3>
                    <p style="line-height: 1.8; color: var(--text-secondary); font-size: 0.95rem;">
                        是的，SoundFlows 完全免费，无需绑定信用卡，也不用下载 App。213+ 首疗愈音频可在任何设备的浏览器中直接播放。你可以选择注册账号来保存收藏、同步进度，也可以继续以访客身份使用全部核心功能。我们的使命是让声音疗法对所有人可得，而不是追求商业利润。
                    </p>
                </div>

                <!-- FAQ 6 -->
                <div style="background: var(--bg-card); padding: 1.75rem; border-radius: 12px; border: 1px solid var(--border-subtle);">
                    <h3 style="font-size: 1.25rem; color: var(--text-primary); margin-bottom: 0.75rem;">
                        听声音疗愈音频要多久才有效？
                    </h3>
                    <p style="line-height: 1.8; color: var(--text-secondary); font-size: 0.95rem;">
                        <strong>睡眠：</strong> 30-60 分钟，若环境噪音持续可整夜播放。<br>
                        <strong>冥想：</strong> 先从 10-15 分钟开始，逐渐延长至 20-30 分钟。<br>
                        <strong>缓解焦虑：</strong> 急性压力时聆听 10-20 分钟；日常预防保持 10 分钟即可。<br>
                        <strong>专注工作：</strong> 25-50 分钟一个区块，搭配 5-10 分钟休息。<br>
                        <strong>脉轮疗愈：</strong> 每个脉轮 10-20 分钟，或全套每个 5-10 分钟。<br>
                        比起时长，规律更重要——每天 10 分钟胜过偶尔 1 小时。
                    </p>
                </div>
            </div>
        </section>
    </div>

    <!-- GDPR/CCPA Compliance Section -->
    <footer class="gdpr-footer" role="contentinfo">
        <div class="gdpr-container">
            <div class="gdpr-links">
                <a href="privacy-policy.html" data-i18n="footer.privacy" target="_blank" rel="noopener">隐私政策</a>
                <span class="separator">|</span>
                <a href="terms-of-service.html" data-i18n="footer.terms" target="_blank" rel="noopener">服务条款</a>
                <span class="separator">|</span>
                <a href="https://status.soundflows.app" target="_blank" rel="noopener">系统状态</a>
                <span class="separator">|</span>
                <button class="gdpr-ccpa-link" onclick="showCookieSettings()" data-i18n="footer.cookieSettings">Cookie设置</button>
                <span class="separator">|</span>
                <button class="gdpr-ccpa-link" onclick="showDataDeletionForm()" data-i18n="footer.dataDeletion">删除我的数据</button>
                <span class="separator">|</span>
                <button class="gdpr-ccpa-link ccpa-opt-out" onclick="toggleCCPAOptOut()" id="ccpaOptOutBtn" data-i18n="footer.doNotSell">拒绝出售个人信息</button>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Sound Healing Space. 保留所有权利。</p>
            </div>
        </div>
    </footer>

    <!-- Structured Data (JSON-LD Schema.org) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "声音疗愈空间 | Sound Healing Space",
      "alternateName": "SoundFlows",
      "url": "https://www.soundflows.app",
      "description": "免费在线声音疗愈平台，提�?13+专业疗愈音频：冥想音乐、自然音效、颂钵音疗、脉轮疗愈、催眠引导、潜意识疗愈。支�?种语言，助您放松身心、改善睡眠、缓解压力�?,
      "applicationCategory": "HealthApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "image": "https://www.soundflows.app/assets/images/og-image.jpg",
      "screenshot": "https://www.soundflows.app/assets/images/app-screenshot.jpg",
      "inLanguage": ["en-US", "zh-CN", "ja-JP", "ko-KR", "es-ES"],
      "featureList": [
        "213+ 免费疗愈音频",
        "9大音频分类：冥想、自然音效、颂钵、脉轮疗愈、催眠、潜意识疗愈、动物音效、火焰音效、流水音�?,
        "支持5种语言界面",
        "睡眠定时器功�?,
        "随机播放和循环播�?,
        "音频播放速度调节",
        "响应式设计，支持移动�?
      ],
      "author": {
        "@type": "Organization",
        "name": "Sound Healing Team",
        "url": "https://www.soundflows.app"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Sound Healing Team",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.soundflows.app/favicon.png"
        }
      },
      "potentialAction": {
        "@type": "ListenAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://www.soundflows.app",
          "actionPlatform": [
            "http://schema.org/DesktopWebPlatform",
            "http://schema.org/MobileWebPlatform"
          ]
        }
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Sound Healing Space",
      "alternateName": "SoundFlows",
      "url": "https://www.soundflows.app",
      "logo": "https://www.soundflows.app/favicon.png",
      "description": "专业在线声音疗愈平台，提供免费音频疗法服�?,
      "foundingDate": "2024",
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "Customer Service",
        "email": "support@soundflows.app",
        "availableLanguage": ["English", "Chinese", "Japanese", "Korean", "Spanish"]
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "声音疗愈音频分类",
      "description": "9大专业音频疗法分�?,
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "冥想音乐",
          "description": "14首专业冥想引导音频，帮助深度放松和内心平�?
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "自然音效 - 雨声",
          "description": "14种不同雨声音效，营造自然放松氛�?
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "颂钵音疗",
          "description": "61首西藏颂钵疗愈音频，平衡能量中心"
        },
        {
          "@type": "ListItem",
          "position": 4,
          "name": "脉轮疗愈",
          "description": "7种脉轮专属疗愈音频，平衡身心能量"
        },
        {
          "@type": "ListItem",
          "position": 5,
          "name": "催眠引导",
          "description": "70首专业催眠音频，改善睡眠质量"
        },
        {
          "@type": "ListItem",
          "position": 6,
          "name": "潜意识疗�?,
          "description": "11首潜意识重塑音频，积极心理建�?
        },
        {
          "@type": "ListItem",
          "position": 7,
          "name": "动物音效",
          "description": "26种自然动物音效，回归大自然怀�?
        },
        {
          "@type": "ListItem",
          "position": 8,
          "name": "火焰音效",
          "description": "4种篝火音效，温暖舒适的氛围�?
        },
        {
          "@type": "ListItem",
          "position": 9,
          "name": "流水音效",
          "description": "6种流水音效，清澈宁静的自然之�?
        }
      ]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "声音疗愈是什么？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "声音疗愈是一种利用特定频率和节奏的声音来促进身心健康的疗法。通过聆听自然音效、冥想音乐、颂钵音疗等专业音频，可以帮助放松身心、改善睡眠、缓解压力和焦虑。"
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈空间提供哪些音频？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "我们提供213+免费专业疗愈音频，分为9大类：冥想音乐（14首）、雨声（14首）、颂钵音疗（61首）、脉轮疗愈（7首）、催眠引导（70首）、潜意识疗愈（11首）、动物音效（26首）、火焰音效（4首）、流水音效（6首）。"
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈空间支持哪些语言？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "我们支持5种语言界面：English (英语)、简体中文、日本語（日语）、한국어（韩语）、Español（西班牙语），方便全球用户使用。"
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈空间是免费的吗？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "是的，完全免费！我们提供的所有213+音频资源都是100%免费使用，无需注册、无需付费、无广告打扰。"
          }
        },
        {
          "@type": "Question",
          "name": "如何使用声音疗愈空间？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "使用非常简单：1) 打开网站 soundflows.app  2) 选择您需要的音频分类  3) 点击播放您喜欢的音频  4) 可以设置睡眠定时器、调节音量、切换播放模式。支持手机、平板和电脑访问。"
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈有科学依据吗？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "是的，有充分的科学依据。研究表明，特定的音频频率可以帮助调节脑波，降低皮质醇水平，促进放松。2023年的系统综述显示，音疗可以使睡眠质量平均改善35%。"
          }
        },
        {
          "@type": "Question",
          "name": "什么声音最适合改善睡眠？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "根据研究，最适合改善睡眠的声音包括：1）粉红噪音 - 增加深睡眠23% 2）雨声 - 缩短入睡时间15分钟 3）白噪音 - 减少夜间觉醒40%。建议音量保持在40-60分贝。"
          }
        },
        {
          "@type": "Question",
          "name": "每天使用声音疗愈安全吗？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "是的，每天使用是安全的。只要注意音量不超过85分贝，仅睡眠时间使用，就不会产生依赖性。研究表明长期使用没有报告严重的副作用。"
          }
        }
      ]
    }
    </script>

    <!-- Additional BreadcrumbList Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "首页",
          "item": "https://soundflows.app"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "声音疗愈",
          "item": "https://soundflows.app"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "冥想音乐",
          "item": "https://soundflows.app?category=meditation"
        }
      ]
    }
    </script>

    <!-- HowTo Schema for Better GEO Visibility -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "如何使用声音疗愈改善睡眠",
      "description": "5步快速学会使用声音疗愈技术改善睡眠质量",
      "image": "https://soundflows.app/assets/images/how-to-sound-therapy.jpg",
      "totalTime": "PT5M",
      "estimatedCost": {
        "@type": "MonetaryAmount",
        "currency": "USD",
        "value": "0"
      },
      "supply": [
        {
          "@type": "HowToSupply",
          "name": "智能手机或电脑"
        },
        {
          "@type": "HowToSupply",
          "name": "耳机或扬声器"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "name": "访问SoundFlows网站",
          "text": "在浏览器中打开 soundflows.app",
          "url": "https://soundflows.app"
        },
        {
          "@type": "HowToStep",
          "name": "选择音频分类",
          "text": "根据您的需求选择分类：雨声助眠、冥想专注或脉轮疗愈"
        },
        {
          "@type": "HowToStep",
          "name": "调节音量",
          "text": "将音量调节到舒适的40-60分贝水平"
        },
        {
          "@type": "HowToStep",
          "name": "设置定时器",
          "text": "如需要，设置睡眠定时器自动关闭"
        },
        {
          "@type": "HowToStep",
          "name": "放松聆听",
          "text": "闭上眼睛，专注于呼吸，让疗愈声音引导您进入深度放松"
        }
      ]
    }
    </script>

    <!-- MedicalWebPage Schema for Health Content -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "MedicalWebPage",
      "name": "声音疗愈 - 科学证明的放松和睡眠改善方法",
      "description": "提供基于科学证据的声音疗愈信息，帮助改善睡眠、缓解压力和焦虑",
      "lastReviewed": "2025-01-23",
      "reviewedBy": {
        "@type": "Organization",
        "name": "Sound Healing Research Team"
      },
      "about": {
        "@type": "Thing",
        "name": "声音疗法"
      },
      "medicalAudience": [
        "Patient",
        "General Public"
      ],
      "typicalAgeRange": "18-100",
      "mainContentOfPage": {
        "@type": "WebPageElement",
        "name": "声音疗愈指南",
        "text": "详细的声音疗愈使用指南和科学研究结果"
      }
    }
    </script>

    <!-- Firebase SDK (v9 Compat 版本) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>

    <!-- Firebase 模块 -->
    <script src="../assets/js/firebase-config.js"></script>
    <script src="../assets/js/firebase-auth-ui.js"></script>

    <!-- External JavaScript Files -->
    <!-- Load in order: error handler �?config �?i18n �?user data �?metadata �?video background �?app logic �?features �?enhancements -->
    <script src="../assets/js/global-error-handler.js"></script>
    <script src="../assets/js/audio-config.js"></script>
    <script src="../assets/js/i18n-system.js"></script>
    <script src="../assets/js/i18n-translations-addon.js"></script>
    <script src="../assets/js/i18n-extra-translations.js"></script>
    <script src="../assets/js/language-integration.js"></script>
    <script src="../assets/js/cookie-consent-manager.js"></script>
    <script src="../assets/js/email-templates.js"></script>
    <script src="../assets/js/content-i18n-manager.js"></script>
    <script src="../assets/js/sentry-error-tracking.js"></script>
    <script src="../assets/js/dropdown-login-system.js"></script>
    <script src="../assets/js/social-share.js"></script>
    <script src="../assets/js/gdpr-compliance.js"></script>
    <script src="../assets/js/gdpr-ccpa-handler.js"></script>
    <!-- 视频背景系统 (2.0 新增) -->
    <script src="../assets/js/focus-mode-controller.js"></script>
    <script src="../assets/js/user-data-manager.js"></script>
    <script src="../assets/js/audio-metadata.js"></script>
    <script src="../assets/js/recommendation-engine.js"></script>
    <script src="../assets/js/history-favorites-ui.js"></script>
    <script src="../assets/js/onboarding-tutorial.js"></script>
    <script src="../assets/js/audio-mixer.js"></script>
    <script src="../assets/js/mixer-ui.js"></script>
    <script src="../assets/js/chart-visualizer.js"></script>
    <script src="../assets/js/stats-dashboard.js"></script>
    <script src="../assets/js/favorite-button-controller.js"></script>
    <script src="../assets/js/pwa-manager.js"></script>
    <script src="../assets/js/notification-preferences.js"></script>
    <script src="../assets/js/theme-manager.js"></script>
    <script src="../assets/js/offline-audio-manager.js"></script>
    <script src="../assets/js/daily-meditation-reminder.js"></script>
    <script src="../assets/js/weekly-digest-email.js"></script>
    <script src="../assets/js/email-integration-handler.js"></script>

    <!-- 邮件模板和邮件服务 -->
    <script data-lazy-src="../assets/js/email-templates-i18n.js"></script>
    <script data-lazy-src="../assets/js/email-service-mailgun.js"></script>
    <script data-lazy-src="../assets/js/email-service-sendgrid.js"></script>
    <script data-lazy-src="../assets/js/email-service-brevo.js"></script>
    <script data-lazy-src="../assets/js/email-service-formspree.js"></script>
    <script data-lazy-src="../assets/js/email-service-emailjs.js"></script>
    <script data-lazy-src="quick-formspree-config.js"></script>

    <!-- 🎵 2.0 新增: 音频预加载和Autoplay检测器 -->
    <script src="../assets/js/autoplay-detector.js"></script>
    <script src="../assets/js/audio-preloader.js"></script>

<script>
        document.addEventListener('DOMContentLoaded', () => {
            const planButtons = document.querySelectorAll('[data-track="plan-open"]');
            const statsButtons = document.querySelectorAll('[data-track="stats-open"]');
            const personaToggle = document.querySelector('.header__persona-toggle');
            const personaNav = document.getElementById('personaMenu');
            const personaLinks = personaNav ? personaNav.querySelectorAll('.mega-menu__item') : [];
            const conversionSection = document.querySelector('#conversionOffer');
            const form = document.getElementById('planRequestForm');
            const successNotice = document.querySelector('.conversion-offer__success');
            const submitBtn = form ? form.querySelector('button[type="submit"]') : null;
            const mobileToast = document.getElementById('mobileToast');
            const toastCta = mobileToast ? mobileToast.querySelector('.mobile-toast__cta') : null;
            const toastClose = mobileToast ? mobileToast.querySelector('.mobile-toast__close') : null;
            const toastKey = 'planToastDismissed';

            const pushEvent = (name, detail = {}) => {
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({ event: name, ...detail });
                if (typeof gtag === 'function') {
                    gtag('event', name, detail);
                }
            };

            planButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const target = btn.dataset.scrollTarget ? document.querySelector(btn.dataset.scrollTarget) : conversionSection;
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                    pushEvent('plan_interest', {
                        cta_source: btn.dataset.cta || 'hero'
                    });
                    if (mobileToast) {
                        mobileToast.classList.remove('is-visible');
                        localStorage.setItem(toastKey, '1');
                    }
                });
            });

            statsButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    pushEvent('stats_open', {
                        cta_source: btn.dataset.cta || 'feature-summary'
                    });
                    if (window.statsDashboard && typeof window.statsDashboard.open === 'function') {
                        window.statsDashboard.open();
                    }
                });
            });

            if (personaToggle && personaNav) {
                const closePersona = () => {
                    personaNav.classList.remove('is-open');
                    personaToggle.setAttribute('aria-expanded', 'false');
                    personaNav.setAttribute('aria-hidden', 'true');
                };

                personaToggle.addEventListener('click', () => {
                    const isOpen = personaNav.classList.toggle('is-open');
                    personaToggle.setAttribute('aria-expanded', String(isOpen));
                    personaNav.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
                    if (isOpen) {
                        pushEvent('persona_open', {});
                    }
                });

                personaLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        pushEvent('persona_select', {
                            persona: link.dataset.cta || link.textContent.trim()
                        });
                        closePersona();
                    });
                });

                document.addEventListener('click', (evt) => {
                    if (!personaNav.contains(evt.target) && evt.target !== personaToggle) {
                        if (personaNav.classList.contains('is-open')) {
                            closePersona();
                        }
                    }
                });

                const mq = window.matchMedia('(min-width: 1024px)');
                const handleMQ = (e) => {
                    if (e.matches) {
                        personaNav.classList.remove('is-open');
                        personaToggle.setAttribute('aria-expanded', 'false');
                        personaNav.setAttribute('aria-hidden', 'false');
                    } else {
                        personaNav.setAttribute('aria-hidden', 'true');
                    }
                };
                mq.addEventListener('change', handleMQ);
                handleMQ(mq);
            }

            if (mobileToast) {
                const showToast = () => {
                    if (!mobileToast.classList.contains('is-visible')) {
                        mobileToast.classList.add('is-visible');
                    }
                };

                const scheduleToast = () => {
                    if (window.matchMedia('(max-width: 767px)').matches && !localStorage.getItem(toastKey)) {
                        setTimeout(() => {
                            if (!localStorage.getItem(toastKey)) {
                                showToast();
                            }
                        }, 8000);
                    }
                };

                scheduleToast();
                window.matchMedia('(max-width: 767px)').addEventListener('change', (mq) => {
                    if (mq.matches) {
                        scheduleToast();
                    } else {
                        mobileToast.classList.remove('is-visible');
                    }
                });

                if (toastCta) {
                    toastCta.addEventListener('click', () => {
                        mobileToast.classList.remove('is-visible');
                        localStorage.setItem(toastKey, '1');
                    });
                }

                if (toastClose) {
                    toastClose.addEventListener('click', () => {
                        mobileToast.classList.remove('is-visible');
                        localStorage.setItem(toastKey, '1');
                    });
                }
            }

            if (form) {
                form.addEventListener('submit', (event) => {
                    event.preventDefault();
                    const siteConfig = window.SITE_CONFIG || {};
                    if (!form.reportValidity()) {
                        pushEvent('plan_validation_error', {
                            reason: 'invalid_fields',
                            form_id: 'planRequestForm'
                        });
                        return;
                    }

                    if (successNotice) {
                        successNotice.classList.remove('is-visible');
                    }

                    const formData = new FormData(form);
                    const payload = {
                        name: (formData.get('name') || '').toString().trim(),
                        email: (formData.get('email') || '').toString().trim(),
                        goal: formData.get('goal') || '',
                        time: formData.get('time') || '',
                        form_id: 'planRequestForm',
                        funnel_step: 'plan_submit',
                        source: 'plan-request'
                    };

                    if (submitBtn) {
                        submitBtn.disabled = true;
                        submitBtn.textContent = 'Submitting...';
                    }

                    pushEvent('plan_submit', payload);

                    const emailAutomationPromise = window.emailAutomation && typeof window.emailAutomation.emitEvent === 'function'
                        ? window.emailAutomation.emitEvent('plan_submit', Object.assign({}, payload))
                        : Promise.resolve({ skipped: true });

                    const crmSender = window.crmBridge && typeof window.crmBridge.sendToCrm === 'function'
                        ? window.crmBridge.sendToCrm(siteConfig.planEndpoint, Object.assign({ event: 'plan_submit', form_name: 'conversionOffer' }, payload))
                        : Promise.resolve({ skipped: true });

                    crmSender.then(() => {
                        return emailAutomationPromise.then(() => {
                            pushEvent('plan_automation_success', Object.assign({
                                automation_status: 'success'
                            }, payload));
                        }).catch((automationError) => {
                            console.error('Plan email automation failed', automationError);
                            pushEvent('plan_automation_error', Object.assign({
                                automation_status: 'error',
                                error_message: automationError && automationError.message ? automationError.message : 'unknown_error'
                            }, payload));
                        });
                    }).then(() => {
                        if (successNotice) {
                            successNotice.classList.add('is-visible');
                        }
                        if (window.soundFlowsAnalytics && typeof window.soundFlowsAnalytics.trackConversion === 'function') {
                            window.soundFlowsAnalytics.trackConversion('plan_submit', payload.goal || '', {
                                source: 'plan-request',
                                crm_status: 'success',
                                form_id: 'planRequestForm'
                            });
                        }
                        pushEvent('plan_submit_success', Object.assign({ crm_status: 'success' }, payload));
                        form.reset();
                    }).catch((error) => {
                        console.error('Plan submission failed', error);
                        pushEvent('plan_submit_error', Object.assign({
                            crm_status: 'error',
                            error_message: error && error.message ? error.message : 'unknown_error'
                        }, payload));
                        alert('提交失败，请稍后再试。');
                    }).finally(() => {
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Get Custom Plan';
                        }
                    });
                });
            }
        });
    </script>

    <script data-lazy-src="../assets/js/crm-bridge.js"></script>
    <script data-lazy-src="../assets/js/email-automation.js"></script>
    <script src="../assets/js/gtm-events.js"></script>
    <script data-lazy-src="../assets/js/content-hub.js"></script>
    <script data-lazy-src="../assets/js/config.js"></script>
    <!-- Analytics Integration (Amplitude + GA4 + Clarity) -->
    <script data-lazy-src="../assets/js/analytics.js"></script>
    <script src="../assets/js/index-app.js"></script>
    <!-- Player Modal Controller - 弹窗播放器控制 -->
    <script src="../assets/js/player-modal-controller.js"></script>
    <!-- UI Redesign v2.0 -->
    <script defer src="../assets/js/ui-redesign-v2.js?v=20251108"></script>

    <!-- Fix Player Position - Prevents audio player from being misplaced -->
    <script src="../assets/js/fix-player-position.js"></script>

    <!-- Ultimate Player Fixes - Final solution for all issues -->
    <script src="../assets/js/ultimate-player-fixes.js"></script>

    <!-- Scrolling Fix - Prevent overlay blocking -->
    <script src="../assets/js/scrolling-fix.js"></script>

    <!-- AudioManager兼容层 - 为旧模块提供window.audioManager -->
    <script src="../assets/js/audioManager-compat.js"></script>
    <script data-lazy-src="../assets/js/touch-gestures.js"></script>
    <script src="../assets/js/accessibility-enhancements.js"></script>
    <!-- Keyboard Navigation and Screen Reader Support -->
    <script src="../assets/js/accessibility-keyboard-navigation.js"></script>
    <!-- Accessibility Testing and Validation -->
    <script data-lazy-src="../assets/js/accessibility-validator.js"></script>
    <!-- Performance Monitor for Canvas Animations -->
    <script data-lazy-src="../assets/js/performance-monitor-overlay.js"></script>
    <!-- Color Contrast Validator for WCAG AA Compliance -->
    <script data-lazy-src="../assets/js/color-contrast-validator.js"></script>
    <script>
        (function setupExperienceHelpers() {
            const lazyScripts = Array.from(document.querySelectorAll('script[data-lazy-src]'));
            let lazyLoaded = false;

            const loadLazyScripts = () => {
                if (lazyLoaded || !lazyScripts.length) {
                    return;
                }
                lazyLoaded = true;
                lazyScripts.forEach((placeholder) => {
                    const src = placeholder.getAttribute('data-lazy-src');
                    if (!src) {
                        return;
                    }
                    const script = document.createElement('script');
                    script.src = src;
                    script.defer = placeholder.defer;
                    script.async = placeholder.async;
                    document.body.appendChild(script);
                });
            };

            const hydrateOnIntent = () => {
                loadLazyScripts();
            };

            window.addEventListener('load', () => {
                setTimeout(loadLazyScripts, 1500);
            });
            document.addEventListener('pointerdown', hydrateOnIntent, { once: true, passive: true });
            document.addEventListener('focusin', hydrateOnIntent, { once: true });

            document.addEventListener('DOMContentLoaded', () => {
                const helpBtn = document.getElementById('tutorialHelpBtn');
                if (helpBtn) {
                    helpBtn.addEventListener('click', () => {
                        if (window.onboardingTutorial && typeof window.onboardingTutorial.show === 'function') {
                            window.onboardingTutorial.show();
                        }
                    });
                }

                const refreshBtn = document.getElementById('refreshRecommendationsBtn');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', () => {
                        if (typeof window.refreshPersonalizedRecommendations === 'function') {
                            window.refreshPersonalizedRecommendations(true);
                        }
                    });
                }
            });
        })();
    </script>


    <!-- Firebase 登录表单处理函数 -->
    <script>
        // 切换认证标签
        function switchAuthTab(tabName) {
            // 隐藏所有表单
            document.getElementById('loginForm').classList.remove('active');
            document.getElementById('signupForm').classList.remove('active');
            document.getElementById('resetForm').classList.remove('active');

            // 移除所有标签的active类
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // 显示选中的表单并激活标签
            switch(tabName) {
                case 'login':
                    document.getElementById('loginForm').classList.add('active');
                    document.querySelectorAll('.auth-tab')[0].classList.add('active');
                    break;
                case 'signup':
                    document.getElementById('signupForm').classList.add('active');
                    document.querySelectorAll('.auth-tab')[1].classList.add('active');
                    break;
                case 'reset':
                    document.getElementById('resetForm').classList.add('active');
                    document.querySelectorAll('.auth-tab')[2].classList.add('active');
                    break;
            }
        }

        // 处理登录
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert(window.getI18nText('auth.filledEmail'));
                return;
            }

            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signInWithEmail(email, password);
                if (result) {
                    // 登录成功，关闭对话框
                    window.firebaseAuthManager.closeAuthDialog();
                    // 清空表单
                    document.getElementById('loginEmail').value = '';
                    document.getElementById('loginPassword').value = '';
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理注册
        async function handleSignup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;

            if (!name || !email || !password) {
                alert(window.getI18nText('auth.filledEmail'));
                return;
            }

            if (password.length < 6) {
                alert(window.getI18nText('auth.passwordMinLength'));
                return;
            }

            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signUpWithEmail(email, password, name);
                if (result) {
                    // 注册成功，关闭对话框
                    window.firebaseAuthManager.closeAuthDialog();
                    // 清空表单
                    document.getElementById('signupName').value = '';
                    document.getElementById('signupEmail').value = '';
                    document.getElementById('signupPassword').value = '';
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理Google登录
        async function handleGoogleLogin() {
            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signInWithGoogle();
                if (result) {
                    window.firebaseAuthManager.closeAuthDialog();
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理匿名登录
        async function handleAnonymousLogin() {
            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signInAnonymously();
                if (result) {
                    window.firebaseAuthManager.closeAuthDialog();
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理密码重置
        async function handlePasswordReset() {
            const email = document.getElementById('resetEmail').value;

            if (!email) {
                alert(window.getI18nText('auth.filledEmail'));
                return;
            }

            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.sendPasswordResetEmail(email);
                if (result) {
                    // 重置邮件发送成功
                    alert(window.getI18nText('auth.resetEmailSent'));
                    window.firebaseAuthManager.closeAuthDialog();
                    document.getElementById('resetEmail').value = '';
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 监听Enter键提交表单
        document.addEventListener('DOMContentLoaded', () => {
            // 登录表单
            const loginPassword = document.getElementById('loginPassword');
            if (loginPassword) {
                loginPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleLogin();
                    }
                });
            }

            // 注册表单
            const signupPassword = document.getElementById('signupPassword');
            if (signupPassword) {
                signupPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleSignup();
                    }
                });
            }

            // 重置表单
            const resetEmail = document.getElementById('resetEmail');
            if (resetEmail) {
                resetEmail.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handlePasswordReset();
                    }
                });
            }
        });
    </script>

    <!-- 初始化主题管理器和每日提醒 -->
    <script>
        // 在DOM加载后初始化主题管理器和每日提醒
        document.addEventListener('DOMContentLoaded', () => {
            window.themeManager = new ThemeManager();
            console.log('✅ 主题管理器已初始化');

            // 初始化每日冥想提醒按钮状态
            if (window.dailyMeditationReminder) {
                updateReminderButton();

                // 监听音频播放事件，当用户完成冥想时标记练习
                if (window.audioManager) {
                    // 当音频播放完成时，可能表示完成了一次冥想练习
                    window.audioManager.addEventListener('audioEnded', () => {
                        // 可以自动标记，或者询问用户是否完成练习
                        console.log('音频播放结束，询问用户是否完成冥想练习');
                    });
                }
            }
        });

        // 更新提醒按钮状态
        function updateReminderButton() {
            const reminderBtn = document.getElementById('reminderBtn');
            const reminderText = document.getElementById('reminderText');

            if (window.dailyMeditationReminder) {
                const status = window.dailyMeditationReminder.getReminderStatus();

                if (status.isEnabled) {
                    reminderBtn.classList.add('has-streak');
                    reminderText.textContent = `${status.streakDays}天连续`;
                } else {
                    reminderBtn.classList.remove('has-streak');
                    reminderText.textContent = '每日提醒';
                }
            }
        }

        // 标记今日冥想练习完成
        function markMeditationPractice() {
            if (window.dailyMeditationReminder) {
                window.dailyMeditationReminder.markTodayPractice();
                updateReminderButton();
            }
        }

        // 添加全局函数供用户调用
        window.markMeditationPractice = markMeditationPractice;
    </script>
</body>
</html>



