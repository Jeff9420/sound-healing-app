﻿﻿﻿﻿﻿﻿﻿﻿﻿                        <div class="mega-menu__layout">
                        <div class="mega-menu" id="megaMenuPersona">
﻿﻿﻿﻿﻿﻿<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Primary Meta Tags -->
    <title>Free Meditation Music & Rain Sounds for Sleeping | 213+ Healing Sounds, White Noise, Nature Sounds | 声音疗愈空间</title>
    <meta name="title" content="声音疗愈空间 - 专业音频疗法平台 | 213+免费疗愈音频">
    <meta name="description" content="Free online sound healing platform with 213+ audio tracks: meditation music, rain sounds for sleeping, white noise, nature sounds, chakra healing, singing bowls, hypnosis. Perfect for relaxation, sleep, stress relief & focus. 5 languages supported. 免费声音疗愈平台�?13+音频助您放松睡眠">
    <meta name="keywords" content="meditation music,rain sounds for sleeping,white noise,nature sounds,sleep sounds,free meditation music,guided meditation,sleep meditation,chakra healing,healing sounds,sound healing,relaxation music,stress relief music,singing bowl,hypnosis audio,ambient sounds,fireplace sounds,water sounds,声音疗愈,冥想音乐,雨声睡眠,白噪�?自然音效,睡眠音乐,放松音乐,减压音乐,颂钵音疗,脉轮疗愈,催眠音频,潜意识疗�?>
    <meta name="author" content="Sound Healing Team">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="language" content="zh-CN">
    <meta name="revisit-after" content="7 days">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.soundflows.app/">

    <!-- Alternate Language Versions (hreflang) -->
    <link rel="alternate" hreflang="zh-CN" href="https://www.soundflows.app/?lang=zh">
    <link rel="alternate" hreflang="en-US" href="https://www.soundflows.app/?lang=en">
    <link rel="alternate" hreflang="ja-JP" href="https://www.soundflows.app/?lang=ja">
    <link rel="alternate" hreflang="ko-KR" href="https://www.soundflows.app/?lang=ko">
    <link rel="alternate" hreflang="es-ES" href="https://www.soundflows.app/?lang=es">
    <link rel="alternate" hreflang="x-default" href="https://www.soundflows.app/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.soundflows.app/">
    <meta property="og:title" content="Free Meditation Music & Rain Sounds for Sleeping | 213+ Healing Sounds">
    <meta property="og:description" content="Free sound healing platform with 213+ audio tracks: meditation music, rain sounds, white noise, nature sounds, chakra healing. Perfect for relaxation, sleep & stress relief. 免费声音疗愈平台">
    <meta property="og:image" content="https://www.soundflows.app/assets/images/og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="声音疗愈空间 - 专业音频疗法平台">
    <meta property="og:site_name" content="Sound Healing Space">
    <meta property="og:locale" content="zh_CN">
    <meta property="og:locale:alternate" content="en_US">
    <meta property="og:locale:alternate" content="ja_JP">
    <meta property="og:locale:alternate" content="ko_KR">
    <meta property="og:locale:alternate" content="es_ES">
    <meta property="og:updated_time" content="2025-10-01T00:00:00+00:00">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://www.soundflows.app/">
    <meta name="twitter:title" content="Free Meditation Music & Rain Sounds for Sleeping | 213+ Healing Sounds">
    <meta name="twitter:description" content="Free sound healing platform: meditation music, rain sounds, white noise, nature sounds. Perfect for relaxation, sleep & stress relief. 免费声音疗愈">
    <meta name="twitter:image" content="https://www.soundflows.app/assets/images/twitter-card.jpg">
    <meta name="twitter:image:alt" content="声音疗愈空间 - 专业音频疗法平台">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- Theme Color -->
    <meta name="theme-color" content="#6666ff">
    <meta name="msapplication-TileColor" content="#6666ff">

    <!-- Preconnect to External Resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- �?Archive.org CDN预连�?- 优化音频/视频加载速度 -->
    <link rel="preconnect" href="https://archive.org">
    <link rel="dns-prefetch" href="https://archive.org">

    <!-- DNS Prefetch -->
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5KF3894B');</script>
    <!-- End Google Tag Manager -->

    <!-- Google Analytics 4 (GA4) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4NZR3HR3J1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      // 配置GA4测量ID
      gtag('config', 'G-4NZR3HR3J1', {
        'send_page_view': true,
        'anonymize_ip': true,
        'cookie_flags': 'SameSite=None;Secure'
      });

      // 自定义事件追�?- 音频播放
      window.trackAudioPlay = function(category, trackName) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'audio_play', {
            'event_category': 'Audio',
            'event_label': category + ' - ' + trackName,
            'audio_category': category,
            'track_name': trackName
          });
        }
      };

      // 自定义事件追�?- 语言切换
      window.trackLanguageChange = function(language) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'language_change', {
            'event_category': 'Engagement',
            'event_label': language
          });
        }
      };

      // 自定义事件追踪 - 睡眠定时器
      window.trackSleepTimer = function(minutes) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'sleep_timer_set', {
            'event_category': 'Feature',
            'event_label': minutes + ' minutes',
            'timer_duration': minutes
          });
        }
      };

      // 自定义事件追踪 - 分享点击
      window.trackShare = function(platform) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'share', {
            'event_category': 'Social',
            'event_label': platform,
            'method': platform
          });
        }
      };
    </script>

    <!-- Preload Critical Resources -->
    <link rel="preload" href="assets/css/index-styles.css" as="style">
    <link rel="preload" href="assets/js/audio-config.js" as="script">
    <link rel="preload" href="assets/js/i18n-system.js" as="script">
    <link rel="preload" href="assets/js/index-app.js" as="script">
    <link rel="preload" href="assets/js/cookie-consent.js" as="script">

    <!-- External Stylesheets -->
    <link rel="stylesheet" href="assets/css/index-styles.css">
    <link rel="stylesheet" href="assets/css/history-favorites.css">
    <link rel="stylesheet" href="assets/css/mixer.css">
    <link rel="stylesheet" href="assets/css/stats-dashboard.css">
    <link rel="stylesheet" href="assets/css/accessibility.css">
    <link rel="stylesheet" href="assets/css/notification-preferences.css">

    <!-- 移动端优化CSS -->
    <link rel="stylesheet" href="assets/css/mobile-optimized.css">
    <link rel="stylesheet" href="assets/css/mobile-enhancement.css">
    <link rel="stylesheet" href="assets/css/touch-target-optimization.css">

    <!-- 主题系统CSS -->
    <link rel="stylesheet" href="assets/css/theme-system.css">

    <!-- 视频背景系统CSS (2.0 新增) -->
    <link rel="stylesheet" href="assets/css/video-background.css">
    <link rel="stylesheet" href="assets/css/focus-mode.css">

    <!-- Analytics Configuration (Load before analytics.js) -->
    <script src="assets/js/analytics-config.js"></script>

    <!-- Amplitude Web SDK with Autocapture -->
    <script src="https://cdn.amplitude.com/script/b6c4ebe3ec4d16c8f5fd258d29653cfc.js"></script>
    <script>
        window.amplitude.add(window.sessionReplay.plugin({sampleRate: 1}));
        window.amplitude.init('b6c4ebe3ec4d16c8f5fd258d29653cfc', {
            "fetchRemoteConfig": true,
            "autocapture": {
                "attribution": true,
                "fileDownloads": true,
                "formInteractions": true,
                "pageViews": true,
                "sessions": true,
                "elementInteractions": true,
                "networkTracking": true,
                "webVitals": true,
                "frustrationInteractions": true
            }
        });
    </script>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5KF3894B"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- SEO H1 (Hidden for SEO purposes, screen reader accessible) -->
    <h1 style="position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden;">
        Free Meditation Music, Rain Sounds for Sleeping & White Noise - 213+ Healing Sounds Online
    </h1>

    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-spinner"></div>
        <div class="loading-text" data-i18n="loading.text">
            🎵 正在加载声音疗愈空间...<br>
            <small data-i18n="loading.subtext">请稍候，正在加载疗愈音频</small>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app">
        <!-- Background Canvas -->
        <canvas id="backgroundCanvas"></canvas>

        <!-- Header -->
        <div class="container">
            <header class="header">
                <div class="header__inner">
                    <div class="header__brand">
                        <span class="header__icon" aria-hidden="true">🎵</span>
                        <div class="header__brand-text">
                            <span class="header__title" data-i18n="app.title">声音疗愈空间</span>
                            <span class="header__tagline" data-i18n="header.tagline">Soundflows · 数字音疗工作室</span>
                        </div>
                    </div>
                    <button class="header__persona-toggle" data-menu="persona" aria-controls="personaMenu" aria-expanded="false" data-i18n="nav.persona.toggle">使用目标</button>
                    <nav class="header__persona-nav" id="personaMenu" aria-label="使用目标" aria-hidden="true">
                        <div class="mega-menu__layout">
                            <a class="mega-menu__item" data-cta="persona-meditation" href="pages/meditation/index.html">
                                <span class="mega-menu__title" data-i18n="nav.persona.meditation.title">冥想专注</span>
                                <span class="mega-menu__desc" data-i18n="nav.persona.meditation.desc">晨间正念与全天专注练习</span>
                            </a>
                            <a class="mega-menu__item" data-cta="persona-sleep" href="pages/rain-sounds/index.html">
                                <span class="mega-menu__title" data-i18n="nav.persona.sleep.title">深度睡眠</span>
                                <span class="mega-menu__desc" data-i18n="nav.persona.sleep.desc">雨声与白噪声音引导快速入睡</span>
                            </a>
                            <a class="mega-menu__item" data-cta="persona-balance" href="pages/chakra-healing/index.html">
                                <span class="mega-menu__title" data-i18n="nav.persona.balance.title">能量平衡</span>
                                <span class="mega-menu__desc" data-i18n="nav.persona.balance.desc">脉轮共振与气场净化</span>
                            </a>
                            <a class="mega-menu__item" data-cta="persona-emotion" href="pages/subconscious-therapy/index.html">
                                <span class="mega-menu__title" data-i18n="nav.persona.emotion.title">情绪疗愈</span>
                                <span class="mega-menu__desc" data-i18n="nav.persona.emotion.desc">潜意识疗愈与压力释放</span>
                            </a>
                        </div>
                    </nav>
                    <a class="header__nav-link" href="pages/resources/index.html" data-cta="nav-resources" data-i18n="nav.resources">资源中心</a>
                    <div class="header__menu">
                        <nav class="header__actions" aria-label="快捷功能">
                        <!-- Login Button -->
                        <button id="loginBtn" class="header-icon-btn" onclick="window.firebaseAuthManager && window.firebaseAuthManager.openAuthDialog()" title="登录/注册">
                            👤
                        </button>

                        <!-- History & Favorites Buttons -->
                        <button class="header-icon-btn" onclick="window.historyFavoritesUI && window.historyFavoritesUI.openPanel('history')" title="播放历史">
                            📜
                        </button>
                        <button class="header-icon-btn" onclick="window.historyFavoritesUI && window.historyFavoritesUI.openPanel('favorites')" title="我的收藏">
                            &#10084;
                        </button>
                        <button class="header-icon-btn" onclick="window.mixerUI && window.mixerUI.open()" title="音频混音台">
                            🎚️
                        </button>
                        <button class="header-icon-btn" onclick="window.statsDashboard && window.statsDashboard.open()" title="收听统计">
                            📊
                        </button>
                        <button class="header-icon-btn" onclick="window.notificationPreferences && window.notificationPreferences.openSettings()" title="通知设置">
                            🔔
                        </button>
                        <!-- Focus Mode Toggle (2.0 新增) -->
                        <button id="focusModeToggle" class="header-icon-btn" onclick="window.focusModeController && window.focusModeController.toggle()" title="专注模式">
                            🎯
                        </button>
                        <!-- Theme Toggle Button -->
                        <button id="themeToggle" class="header-icon-btn theme-toggle-btn" title="切换主题">
                            <span class="theme-icon">🌙</span>
                        </button>
                        <!-- Language Selector -->
                        <div class="language-selector">
                            <select id="languageSelect" onchange="changeLanguage(this.value)">
                                <option value="zh-CN" selected>中文</option>
                                <option value="en-US">English</option>
                                <option value="ja-JP">日本語</option>
                                <option value="ko-KR">한국어</option>
                                <option value="es-ES">Español</option>
                            </select>
                        </div>
                    </nav>
                    </div>
                </div>
            </header>

            <section class="hero-intro" id="heroIntro">
                <div class="hero-intro__content">
                    <p class="hero-intro__eyebrow" data-i18n="hero.eyebrow">专业声音疗愈 · 5 种语言随时可用</p>
                    <h2 class="hero-intro__headline" data-i18n="hero.headline">213+ 沉浸式疗愈音频，帮你在 5 分钟内放松、睡眠与重启专注</h2>
                    <p class="hero-intro__description" data-i18n="hero.description">
                        从雨林白噪到脉轮共振，一键进入专属音疗空间。个性化播放、混音、统计与离线缓存，让每一次呼吸都被疗愈。
                    </p>
                                        <div class="hero-intro__cta-group">
                        <button class="hero-intro__cta-primary" data-cta="start-experience" data-i18n="hero.cta.primary"
                            onclick="document.getElementById('categoryGrid').scrollIntoView({ behavior: 'smooth', block: 'start' });">
                            立即开启沉浸体验
                        </button>
                        <a class="hero-intro__cta-secondary" data-cta="view-highlights" data-i18n="hero.cta.secondary" href="#featureHighlights">
                            查看核心亮点
                        </a>
                        <button type="button" class="hero-intro__cta-secondary hero-intro__cta-plan" data-track="plan-open" data-scroll-target="#conversionOffer" data-i18n="hero.cta.plan">
                            获取定制冥想计划
                        </button>
                    </div>
                </div>
                <div class="hero-intro__stats">
                    <div class="hero-intro__stat">
                        <span class="hero-intro__stat-number">213+</span>
                        <span class="hero-intro__stat-label" data-i18n="hero.stats.audio">疗愈音频与白噪合集</span>
                    </div>
                    <div class="hero-intro__stat">
                        <span class="hero-intro__stat-number">9</span>
                        <span class="hero-intro__stat-label" data-i18n="hero.stats.scenes">场景主题随情绪切换</span>
                    </div>
                    <div class="hero-intro__stat">
                        <span class="hero-intro__stat-number">5</span>
                        <span class="hero-intro__stat-label" data-i18n="hero.stats.languages">语言界面全球同步</span>
                    </div>
                </div>
            </section>

            <section class="feature-summary" id="featureHighlights">
                <div class="feature-summary__heading">
                    <h3 data-i18n="features.heading.title">为什么选择声音疗愈空间？</h3>
                    <p data-i18n="features.heading.desc">我们把专业音疗体验压缩进一个浏览器，在任何设备上都能获取科学、柔和且富有仪式感的放松流程。</p>
                    <button type="button" class="feature-summary__cta" data-track="stats-open" data-cta="feature-summary" data-i18n="features.heading.cta">了解专业音疗统计</button>
                </div>
                <div class="feature-summary__grid">
                    <article class="feature-card">
                        <h4 data-i18n="features.card1.title">沉浸场景秒匹配</h4>
                        <p data-i18n="features.card1.desc">根据分类智能切换视频背景与氛围动画，自然进入与情绪相匹配的疗愈空间。</p>
                    </article>
                    <article class="feature-card">
                        <h4 data-i18n="features.card2.title">个性混音与收藏</h4>
                        <p data-i18n="features.card2.desc">混合雨声、白噪、颂钵等元素，保存个人配方并跨设备同步历史记录。</p>
                    </article>
                    <article class="feature-card">
                        <h4 data-i18n="features.card3.title">专注模式与睡眠定时</h4>
                        <p data-i18n="features.card3.desc">全屏专注视图与智能睡眠定时器，让冥想、午休与夜间睡眠都更轻松。</p>
                    </article>
                    <article class="feature-card">
                        <h4 data-i18n="features.card4.title">数据可视化洞察</h4>
                        <p data-i18n="features.card4.desc">内置统计面板记录播放频率、时长与偏好，帮助你建立持续的自我照护节奏。</p>
                    </article>
                </div>
            </section>

            <section class="journey-showcase" id="journeyShowcase">
                <div class="journey-showcase__heading">
                    <h3 data-i18n="journey.heading.title">选择与你状态匹配的疗愈旅程</h3>
                    <p data-i18n="journey.heading.desc">按目标切换专属声景，立即开始更聚焦的冥想、睡眠或情绪舒缓流程。</p>
                </div>
                <div class="journey-showcase__grid">
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.meditation.label">冥想专注</div>
                        <h4 data-i18n="journey.meditation.title">晨间冥想 & 日常正念</h4>
                        <p data-i18n="journey.meditation.desc">精选颂钵与呼吸声景，配合轻引导帮助你在 10 分钟内回到觉察与平静。</p>
                        <a class="journey-card__cta" href="pages/meditation/index.html" data-i18n="journey.meditation.cta">进入冥想旅程 →</a>
                    </article>
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.sleep.label">深度睡眠</div>
                        <h4 data-i18n="journey.sleep.title">夜间放松 & 快速入睡</h4>
                        <p data-i18n="journey.sleep.desc">组合雨声、白噪与定时器，温柔覆盖夜晚每个阶段，让思绪慢慢沉静。</p>
                        <a class="journey-card__cta" href="pages/rain-sounds/index.html" data-i18n="journey.sleep.cta">打开心流睡眠 →</a>
                    </article>
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.balance.label">能量平衡</div>
                        <h4 data-i18n="journey.balance.title">脉轮疗愈 & 气场净化</h4>
                        <p data-i18n="journey.balance.desc">七大脉轮共振与水晶音浴，帮助身体与情绪重新找回内部秩序。</p>
                        <a class="journey-card__cta" href="pages/chakra-healing/index.html" data-i18n="journey.balance.cta">感受能量复位 →</a>
                    </article>
                    <article class="journey-card">
                        <div class="journey-card__label" data-i18n="journey.emotion.label">情绪疗愈</div>
                        <h4 data-i18n="journey.emotion.title">释放焦虑与压力</h4>
                        <p data-i18n="journey.emotion.desc">潜意识疗愈与引导式放松，陪你走过日常压力、告别负面循环。</p>
                        <a class="journey-card__cta" href="pages/subconscious-therapy/index.html" data-i18n="journey.emotion.cta">开始情绪舒缓 →</a>
                    </article>
                </div>
            </section>

            <section class="conversion-offer" id="conversionOffer">
                <div class="conversion-offer__content">
                    <h3 data-i18n="form.plan.title">领取你的 7 日定制冥想计划</h3>
                    <p data-i18n="form.plan.description">告诉我们你当前的状态，我们会组合合适的声景、冥想练习与睡眠建议，发送一份结构化的 7 日音疗安排。</p>
                    <ul>
                        <li data-i18n="form.plan.benefit1">每日 2 份推荐音频与练习提示</li>
                        <li data-i18n="form.plan.benefit2">结合睡眠或专注目标的提醒计划</li>
                        <li data-i18n="form.plan.benefit3">个性化混音建议与进度跟踪指引</li>
                    </ul>
                </div>
                <div class="conversion-offer__form">
                    <form id="planRequestForm" novalidate>
                        <div class="conversion-offer__field">
                            <label for="planName" data-i18n="form.plan.label.name">你的昵称</label>
                            <input id="planName" name="name" type="text" data-i18n-placeholder="form.plan.placeholder.name" placeholder="如：小觉" required>
                        </div>
                        <div class="conversion-offer__field">
                            <label for="planEmail" data-i18n="form.plan.label.email">联系邮箱</label>
                            <input id="planEmail" name="email" type="email" data-i18n-placeholder="form.plan.placeholder.email" placeholder="your@email.com" required>
                        </div>
                        <div class="conversion-offer__field">
                            <label for="planGoal" data-i18n="form.plan.label.goal">当前最想改善的目标</label>
                            <select id="planGoal" name="goal" required>
                                <option value="" data-i18n="form.plan.goal.select">请选择</option>
                                <option value="sleep" data-i18n="form.plan.goal.sleep">提升睡眠质量</option>
                                <option value="focus" data-i18n="form.plan.goal.focus">提升专注效率</option>
                                <option value="stress" data-i18n="form.plan.goal.stress">缓解焦虑与压力</option>
                                <option value="mindfulness" data-i18n="form.plan.goal.mindfulness">建立规律冥想习惯</option>
                            </select>
                        </div>
                        <div class="conversion-offer__field">
                            <label for="planTime" data-i18n="form.plan.label.time">每日可投入的时长</label>
                            <select id="planTime" name="time" required>
                                <option value="" data-i18n="form.plan.time.select">请选择</option>
                                <option value="5-10" data-i18n="form.plan.time.5-10">5-10 分钟</option>
                                <option value="10-20" data-i18n="form.plan.time.10-20">10-20 分钟</option>
                                <option value="20-30" data-i18n="form.plan.time.20-30">20-30 分钟</option>
                                <option value="30+" data-i18n="form.plan.time.30+">30 分钟以上</option>
                            </select>
                        </div>
                        <button type="submit" class="conversion-offer__submit" data-track="plan-submit" data-i18n="form.plan.submit">领取定制计划</button>
                    </form>
                    <div class="conversion-offer__success" aria-live="polite" data-i18n="form.plan.success">
                        ✅ 计划申请成功！我们会在 5 分钟内将定制冥想安排发送至你的邮箱，请注意查收。
                    </div>
                </div>
            </section>

            <!-- Category Section -->
            <section class="content-hub" id="contentHub">
                <div class="content-hub__intro">
                    <h3 data-i18n="content.heading.title">疗愈知识库 · 每天 10 分钟提升身心觉察</h3>
                    <p data-i18n="content.heading.desc">精选文章、实践指南与短视频，结合音疗技巧与真实案例，让"听"与"做"更有结构。</p>
                    <a class="content-hub__cta" href="pages/resources/index.html" data-i18n="content.heading.cta">访问全部内容 →</a>
                </div>
                <div class="content-hub__grid">
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card1.tag">指南</div>
                        <h4 data-i18n="content.card1.title">30 分钟睡前音疗步骤</h4>
                        <p data-i18n="content.card1.desc">按照"缓和呼吸 → 白噪预热 → 深度冥想"的三段结构，快速进入深层睡眠。</p>
                        <a class="content-card__link" href="pages/resources/sleep-routine.html" data-i18n="content.card1.link">阅读指南 →</a>
                    </article>
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card2.tag">视频</div>
                        <h4 data-i18n="content.card2.title">雨声 + 颂钵混音实操</h4>
                        <p data-i18n="content.card2.desc">1 分钟学会在混音台里叠加雨声与颂钵，让午后专注更稳定。</p>
                        <button class="content-card__link" data-track="content-video" data-video="videos/rain-bowl-demo.mp4" data-i18n="content.card2.link">即刻观看 →</button>
                    </article>
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card3.tag">案例</div>
                        <h4 data-i18n="content.card3.title">设计师小安的晨间冥想</h4>
                        <p data-i18n="content.card3.desc">看看她如何用 7 日音疗计划缓解焦虑，并保持每周 5 次冥想的习惯。</p>
                        <a class="content-card__link" href="pages/resources/case-designer-an.html" data-i18n="content.card3.link">查看故事 →</a>
                    </article>
                    <article class="content-card">
                        <div class="content-card__tag" data-i18n="content.card4.tag">音疗笔记</div>
                        <h4 data-i18n="content.card4.title">脉轮共振与情绪释放</h4>
                        <p data-i18n="content.card4.desc">从颜色、频率到身体对应部位，了解脉轮疗愈的科学基础与入门练习。</p>
                        <a class="content-card__link" href="pages/resources/chakra-cheatsheet.html" data-i18n="content.card4.link">下载笔记 →</a>
                    </article>
                </div>
            </section>

            <section class="impact-proof" id="impactProof">
                <div class="impact-proof__grid">
                    <article class="impact-card impact-card--stats">
                        <h4 data-i18n="impact.stats.title">38% 用户完成 7 日引导疗程</h4>
                        <p data-i18n="impact.stats.desc">基于 2025 年匿名数据，持续使用混音 + 冥想方案的用户中，有 38% 成功完成我们推荐的深度疗愈课程。</p>
                        <button type="button" class="impact-card__cta" data-track="stats-open" data-cta="impact-stats" data-i18n="impact.stats.cta">查看详细数据面板</button>
                    </article>
                    <article class="impact-card impact-card--story">
                        <h4 data-i18n="impact.story.title">用户故事 · 设计师小安的转变</h4>
                        <p data-i18n="impact.story.desc">通过 7 日音疗计划，她将晨间焦虑指数降低 45%，并把 15 分钟冥想融入日常通勤前的仪式。</p>
                        <a class="impact-card__link" href="pages/resources/case-designer-an.html" data-i18n="impact.story.link">阅读完整故事 →</a>
                    </article>
                </div>
            </section>

            <section class="category-section">
                <div id="categoryGrid" class="category-grid">
                    <!-- Categories will be loaded here by JavaScript -->
                </div>
            </section>
        </div>

        <!-- Playlist Modal -->
        <div id="playlistModal" class="playlist-modal">
            <div class="modal-content">
                <span class="close" onclick="closePlaylist()" data-i18n="modal.close">&times;</span>
                <h2 id="playlistTitle" data-i18n="playlist.title">选择音频</h2>
                <div id="trackList" class="track-list"></div>
            </div>
        </div>

        <!-- Audio Player -->
        <div id="audioPlayer" class="audio-player" onclick="if(isMinimized) toggleMinimize()">
            <div class="minimize-indicator" onclick="toggleMinimize(event)" data-i18n="player.minimize">▼收起</div>
            <div class="minimized-display">
                <div class="minimized-text" id="minimizedTrack" data-i18n="player.notPlaying">未播放</div>
            </div>
            <div class="player-content">
                <div class="now-playing">
                    <div id="currentTrack" class="track-title" data-i18n="player.notPlaying">未播放</div>
                    <div id="currentCategory" class="track-category"></div>
                </div>

                <div class="player-controls">
                    <button class="control-btn" onclick="previousTrack()">⏮️</button>
                    <button id="playPauseBtn" class="control-btn play-btn" onclick="togglePlayPause()">▶️</button>
                    <button class="control-btn" onclick="nextTrack()">⏭️</button>
                    <button class="control-btn" onclick="stopAudio()">⏹️</button>
                </div>

                <div class="progress-container">
                    <span id="currentTime" class="time-display">0:00</span>
                    <div class="progress-bar" onclick="seekTo(event)">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>
                    <span id="duration" class="time-display">0:00</span>
                </div>

                <!-- Additional Controls -->
                <div class="extra-controls">
                    <div class="control-group">
                        <button class="control-btn" id="shuffleBtn" onclick="toggleShuffle()" data-i18n-title="player.shuffle">🔀</button>
                        <button class="control-btn" id="repeatBtn" onclick="toggleRepeat()" data-i18n-title="player.repeat">🔁</button>
                        <button class="control-btn" id="sleepTimerBtn" onclick="toggleSleepTimer()" data-i18n-title="player.sleepTimer">⏰</button>
                    </div>

                    <div class="control-group">
                        <span style="margin-right: 10px;">🔊</span>
                        <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70" onchange="changeVolume(this.value)">
                        <span id="volumeValue" style="margin-left: 10px; min-width: 35px;">70%</span>
                    </div>

                    <div class="control-group">
                        <span style="margin-right: 10px;">⏱️</span>
                        <select id="playbackRate" class="playback-rate" onchange="changePlaybackRate(this.value)">
                            <option value="0.5">0.5x</option>
                            <option value="0.75">0.75x</option>
                            <option value="1" selected>1x</option>
                            <option value="1.25">1.25x</option>
                            <option value="1.5">1.5x</option>
                            <option value="2">2x</option>
                        </select>
                    </div>
                </div>

                <!-- Sleep Timer Modal -->
                <div id="sleepTimerModal" class="timer-modal" style="display: none;">
                    <div class="timer-content">
                        <h3 data-i18n="timer.title">睡眠定时器</h3>
                        <div class="timer-options">
                            <button onclick="setSleepTimer(5)" data-i18n="timer.5min">5分钟</button>
                            <button onclick="setSleepTimer(10)" data-i18n="timer.10min">10分钟</button>
                            <button onclick="setSleepTimer(15)" data-i18n="timer.15min">15分钟</button>
                            <button onclick="setSleepTimer(30)" data-i18n="timer.30min">30分钟</button>
                            <button onclick="setSleepTimer(60)" data-i18n="timer.60min">60分钟</button>
                            <button onclick="setSleepTimer(0)" data-i18n="timer.off">关闭</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Rating Widget -->
        <div id="rating-widget"></div>

        <!-- Firebase Authentication Dialog -->
        <div id="authDialog" class="auth-dialog" style="display: none;">
            <div class="auth-modal-content">
                <div class="auth-header">
                    <h2>登录 / 注册</h2>
                    <button class="auth-close" onclick="window.firebaseAuthManager && window.firebaseAuthManager.closeAuthDialog()">&times;</button>
                </div>

                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')">登录</button>
                    <button class="auth-tab" onclick="switchAuthTab('signup')">注册</button>
                    <button class="auth-tab" onclick="switchAuthTab('reset')">重置密码</button>
                </div>

                <!-- Login Form -->
                <div id="loginForm" class="auth-form active">
                    <div class="form-group">
                        <label>邮箱地址</label>
                        <input type="email" id="loginEmail" placeholder="请输入邮箱">
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="loginPassword" placeholder="请输入密码">
                    </div>
                    <button class="auth-btn primary" onclick="handleLogin()">登录</button>
                    <button class="auth-btn secondary" onclick="handleGoogleLogin()">使用 Google 登录</button>
                    <button class="auth-btn secondary" onclick="handleAnonymousLogin()">匿名登录</button>
                </div>

                <!-- Signup Form -->
                <div id="signupForm" class="auth-form">
                    <div class="form-group">
                        <label>显示名称</label>
                        <input type="text" id="signupName" placeholder="请输入您的昵称">
                    </div>
                    <div class="form-group">
                        <label>邮箱地址</label>
                        <input type="email" id="signupEmail" placeholder="请输入邮箱">
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="signupPassword" placeholder="至少6位字符">
                    </div>
                    <button class="auth-btn primary" onclick="handleSignup()">注册</button>
                </div>

                <!-- Reset Form -->
                <div id="resetForm" class="auth-form">
                    <div class="form-group">
                        <label>邮箱地址</label>
                        <input type="email" id="resetEmail" placeholder="请输入注册时使用的邮箱">
                    </div>
                    <button class="auth-btn primary" onclick="handlePasswordReset()">发送重置邮件</button>
                </div>
            </div>
        </div>

        <!-- User Profile Display -->
        <div id="userProfile" class="user-profile" style="display: none;">
            <!-- 用户信息将在这里动态显示 -->
        </div>

        <!-- Notification -->
        <div id="notification" class="notification"></div>
    </div>

    <!-- Structured Data (JSON-LD Schema.org) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "声音疗愈空间 | Sound Healing Space",
      "alternateName": "SoundFlows",
      "url": "https://www.soundflows.app",
      "description": "免费在线声音疗愈平台，提�?13+专业疗愈音频：冥想音乐、自然音效、颂钵音疗、脉轮疗愈、催眠引导、潜意识疗愈。支�?种语言，助您放松身心、改善睡眠、缓解压力�?,
      "applicationCategory": "HealthApplication",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "image": "https://www.soundflows.app/assets/images/og-image.jpg",
      "screenshot": "https://www.soundflows.app/assets/images/app-screenshot.jpg",
      "inLanguage": ["zh-CN", "en-US", "ja-JP", "ko-KR", "es-ES"],
      "featureList": [
        "213+ 免费疗愈音频",
        "9大音频分类：冥想、自然音效、颂钵、脉轮疗愈、催眠、潜意识疗愈、动物音效、火焰音效、流水音�?,
        "支持5种语言界面",
        "睡眠定时器功�?,
        "随机播放和循环播�?,
        "音频播放速度调节",
        "响应式设计，支持移动�?
      ],
      "author": {
        "@type": "Organization",
        "name": "Sound Healing Team",
        "url": "https://www.soundflows.app"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Sound Healing Team",
        "logo": {
          "@type": "ImageObject",
          "url": "https://www.soundflows.app/favicon.png"
        }
      },
      "potentialAction": {
        "@type": "ListenAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://www.soundflows.app",
          "actionPlatform": [
            "http://schema.org/DesktopWebPlatform",
            "http://schema.org/MobileWebPlatform"
          ]
        }
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Sound Healing Space",
      "alternateName": "SoundFlows",
      "url": "https://www.soundflows.app",
      "logo": "https://www.soundflows.app/favicon.png",
      "description": "专业在线声音疗愈平台，提供免费音频疗法服�?,
      "foundingDate": "2024",
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "Customer Service",
        "email": "support@soundflows.app",
        "availableLanguage": ["Chinese", "English", "Japanese", "Korean", "Spanish"]
      }
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "声音疗愈音频分类",
      "description": "9大专业音频疗法分�?,
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "冥想音乐",
          "description": "14首专业冥想引导音频，帮助深度放松和内心平�?
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "自然音效 - 雨声",
          "description": "14种不同雨声音效，营造自然放松氛�?
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "颂钵音疗",
          "description": "61首西藏颂钵疗愈音频，平衡能量中心"
        },
        {
          "@type": "ListItem",
          "position": 4,
          "name": "脉轮疗愈",
          "description": "7种脉轮专属疗愈音频，平衡身心能量"
        },
        {
          "@type": "ListItem",
          "position": 5,
          "name": "催眠引导",
          "description": "70首专业催眠音频，改善睡眠质量"
        },
        {
          "@type": "ListItem",
          "position": 6,
          "name": "潜意识疗�?,
          "description": "11首潜意识重塑音频，积极心理建�?
        },
        {
          "@type": "ListItem",
          "position": 7,
          "name": "动物音效",
          "description": "26种自然动物音效，回归大自然怀�?
        },
        {
          "@type": "ListItem",
          "position": 8,
          "name": "火焰音效",
          "description": "4种篝火音效，温暖舒适的氛围�?
        },
        {
          "@type": "ListItem",
          "position": 9,
          "name": "流水音效",
          "description": "6种流水音效，清澈宁静的自然之�?
        }
      ]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "声音疗愈是什么？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "声音疗愈是一种利用特定频率和节奏的声音来促进身心健康的疗法。通过聆听自然音效、冥想音乐、颂钵音疗等专业音频，可以帮助放松身心、改善睡眠、缓解压力和焦虑�?
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈空间提供哪些音频�?,
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "我们提供213+免费专业疗愈音频，分�?大类：冥想音乐（14首）、雨声（14首）、颂钵音疗（61首）、脉轮疗愈（7首）、催眠引导（70首）、潜意识疗愈�?1首）、动物音效（26首）、火焰音效（4首）、流水音效（6首）�?
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈空间支持哪些语言�?,
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "我们支持5种语言界面：简体中文、English（英语）、日本語（日语）、한국어（韩语）、Español（西班牙语），方便全球用户使用�?
          }
        },
        {
          "@type": "Question",
          "name": "声音疗愈空间是免费的吗？",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "是的，完全免费！我们提供所�?13+音频资源都是100%免费使用，无需注册、无需付费、无广告打扰�?
          }
        },
        {
          "@type": "Question",
          "name": "如何使用声音疗愈空间�?,
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "使用非常简单：1) 打开网站 soundflows.app  2) 选择您需要的音频分类  3) 点击播放您喜欢的音频  4) 可以设置睡眠定时器、调节音量、切换播放模式。支持手机、平板和电脑访问�?
          }
        }
      ]
    }
    </script>

    <!-- Firebase SDK (v9 Compat 版本) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-analytics-compat.js"></script>

    <!-- Firebase 模块 -->
    <script src="assets/js/firebase-config.js"></script>
    <script src="assets/js/firebase-auth-ui.js"></script>

    <!-- External JavaScript Files -->
    <!-- Load in order: error handler �?config �?i18n �?user data �?metadata �?video background �?app logic �?features �?enhancements -->
    <script src="assets/js/global-error-handler.js"></script>
    <script src="assets/js/audio-config.js"></script>
    <script src="assets/js/i18n-system.js"></script>
    <script src="assets/js/i18n-translations-addon.js"></script>
    <script src="assets/js/cookie-consent.js"></script>
    <script src="assets/js/social-share.js"></script>
    <script src="assets/js/gdpr-compliance.js"></script>
    <!-- 视频背景系统 (2.0 新增) -->
    <script src="assets/js/video-background-manager.js"></script>
    <script src="assets/js/focus-mode-controller.js"></script>
    <script src="assets/js/user-data-manager.js"></script>
    <script src="assets/js/audio-metadata.js"></script>
    <script src="assets/js/recommendation-engine.js"></script>
    <script src="assets/js/history-favorites-ui.js"></script>
    <script src="assets/js/audio-mixer.js"></script>
    <script src="assets/js/mixer-ui.js"></script>
    <script src="assets/js/chart-visualizer.js"></script>
    <script src="assets/js/stats-dashboard.js"></script>
    <script src="assets/js/favorite-button-controller.js"></script>
    <script src="assets/js/pwa-manager.js"></script>
    <script src="assets/js/notification-preferences.js"></script>
    <script src="assets/js/theme-manager.js"></script>

    <!-- 🎵 2.0 新增: 音频预加载和Autoplay检测器 -->
    <script src="assets/js/autoplay-detector.js"></script>
    <script src="assets/js/audio-preloader.js"></script>

<script>
        document.addEventListener('DOMContentLoaded', () => {
            const planButtons = document.querySelectorAll('[data-track="plan-open"]');
            const statsButtons = document.querySelectorAll('[data-track="stats-open"]');
            const personaToggle = document.querySelector('.header__persona-toggle');
            const personaNav = document.getElementById('personaMenu');
            const personaLinks = personaNav ? personaNav.querySelectorAll('.mega-menu__item') : [];
            const conversionSection = document.querySelector('#conversionOffer');
            const form = document.getElementById('planRequestForm');
            const successNotice = document.querySelector('.conversion-offer__success');
            const submitBtn = form ? form.querySelector('button[type="submit"]') : null;
            const mobileToast = document.getElementById('mobileToast');
            const toastCta = mobileToast ? mobileToast.querySelector('.mobile-toast__cta') : null;
            const toastClose = mobileToast ? mobileToast.querySelector('.mobile-toast__close') : null;
            const toastKey = 'planToastDismissed';

            const pushEvent = (name, detail = {}) => {
                window.dataLayer = window.dataLayer || [];
                window.dataLayer.push({ event: name, ...detail });
                if (typeof gtag === 'function') {
                    gtag('event', name, detail);
                }
            };

            planButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const target = btn.dataset.scrollTarget ? document.querySelector(btn.dataset.scrollTarget) : conversionSection;
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                    pushEvent('plan_interest', {
                        cta_source: btn.dataset.cta || 'hero'
                    });
                    if (mobileToast) {
                        mobileToast.classList.remove('is-visible');
                        localStorage.setItem(toastKey, '1');
                    }
                });
            });

            statsButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    pushEvent('stats_open', {
                        cta_source: btn.dataset.cta || 'feature-summary'
                    });
                    if (window.statsDashboard && typeof window.statsDashboard.open === 'function') {
                        window.statsDashboard.open();
                    }
                });
            });

            if (personaToggle && personaNav) {
                const closePersona = () => {
                    personaNav.classList.remove('is-open');
                    personaToggle.setAttribute('aria-expanded', 'false');
                    personaNav.setAttribute('aria-hidden', 'true');
                };

                personaToggle.addEventListener('click', () => {
                    const isOpen = personaNav.classList.toggle('is-open');
                    personaToggle.setAttribute('aria-expanded', String(isOpen));
                    personaNav.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
                    if (isOpen) {
                        pushEvent('persona_open', {});
                    }
                });

                personaLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        pushEvent('persona_select', {
                            persona: link.dataset.cta || link.textContent.trim()
                        });
                        closePersona();
                    });
                });

                document.addEventListener('click', (evt) => {
                    if (!personaNav.contains(evt.target) && evt.target !== personaToggle) {
                        if (personaNav.classList.contains('is-open')) {
                            closePersona();
                        }
                    }
                });

                const mq = window.matchMedia('(min-width: 1024px)');
                const handleMQ = (e) => {
                    if (e.matches) {
                        personaNav.classList.remove('is-open');
                        personaToggle.setAttribute('aria-expanded', 'false');
                        personaNav.setAttribute('aria-hidden', 'false');
                    } else {
                        personaNav.setAttribute('aria-hidden', 'true');
                    }
                };
                mq.addEventListener('change', handleMQ);
                handleMQ(mq);
            }

            if (mobileToast) {
                const showToast = () => {
                    if (!mobileToast.classList.contains('is-visible')) {
                        mobileToast.classList.add('is-visible');
                    }
                };

                const scheduleToast = () => {
                    if (window.matchMedia('(max-width: 767px)').matches && !localStorage.getItem(toastKey)) {
                        setTimeout(() => {
                            if (!localStorage.getItem(toastKey)) {
                                showToast();
                            }
                        }, 8000);
                    }
                };

                scheduleToast();
                window.matchMedia('(max-width: 767px)').addEventListener('change', (mq) => {
                    if (mq.matches) {
                        scheduleToast();
                    } else {
                        mobileToast.classList.remove('is-visible');
                    }
                });

                if (toastCta) {
                    toastCta.addEventListener('click', () => {
                        mobileToast.classList.remove('is-visible');
                        localStorage.setItem(toastKey, '1');
                    });
                }

                if (toastClose) {
                    toastClose.addEventListener('click', () => {
                        mobileToast.classList.remove('is-visible');
                        localStorage.setItem(toastKey, '1');
                    });
                }
            }

            if (form) {
                form.addEventListener('submit', (event) => {
                    event.preventDefault();
                    const siteConfig = window.SITE_CONFIG || {};
                    if (!form.reportValidity()) {
                        pushEvent('plan_validation_error', {
                            reason: 'invalid_fields',
                            form_id: 'planRequestForm'
                        });
                        return;
                    }

                    if (successNotice) {
                        successNotice.classList.remove('is-visible');
                    }

                    const formData = new FormData(form);
                    const payload = {
                        name: (formData.get('name') || '').toString().trim(),
                        email: (formData.get('email') || '').toString().trim(),
                        goal: formData.get('goal') || '',
                        time: formData.get('time') || '',
                        form_id: 'planRequestForm',
                        funnel_step: 'plan_submit',
                        source: 'plan-request'
                    };

                    if (submitBtn) {
                        submitBtn.disabled = true;
                        submitBtn.textContent = 'Submitting...';
                    }

                    pushEvent('plan_submit', payload);

                    const emailAutomationPromise = window.emailAutomation && typeof window.emailAutomation.emitEvent === 'function'
                        ? window.emailAutomation.emitEvent('plan_submit', Object.assign({}, payload))
                        : Promise.resolve({ skipped: true });

                    const crmSender = window.crmBridge && typeof window.crmBridge.sendToCrm === 'function'
                        ? window.crmBridge.sendToCrm(siteConfig.planEndpoint, Object.assign({ event: 'plan_submit', form_name: 'conversionOffer' }, payload))
                        : Promise.resolve({ skipped: true });

                    crmSender.then(() => {
                        return emailAutomationPromise.then(() => {
                            pushEvent('plan_automation_success', Object.assign({
                                automation_status: 'success'
                            }, payload));
                        }).catch((automationError) => {
                            console.error('Plan email automation failed', automationError);
                            pushEvent('plan_automation_error', Object.assign({
                                automation_status: 'error',
                                error_message: automationError && automationError.message ? automationError.message : 'unknown_error'
                            }, payload));
                        });
                    }).then(() => {
                        if (successNotice) {
                            successNotice.classList.add('is-visible');
                        }
                        if (window.soundFlowsAnalytics && typeof window.soundFlowsAnalytics.trackConversion === 'function') {
                            window.soundFlowsAnalytics.trackConversion('plan_submit', payload.goal || '', {
                                source: 'plan-request',
                                crm_status: 'success',
                                form_id: 'planRequestForm'
                            });
                        }
                        pushEvent('plan_submit_success', Object.assign({ crm_status: 'success' }, payload));
                        form.reset();
                    }).catch((error) => {
                        console.error('Plan submission failed', error);
                        pushEvent('plan_submit_error', Object.assign({
                            crm_status: 'error',
                            error_message: error && error.message ? error.message : 'unknown_error'
                        }, payload));
                        alert('提交失败，请稍后再试。');
                    }).finally(() => {
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Get Custom Plan';
                        }
                    });
                });
            }
        });
    </script>

    <script src="assets/js/crm-bridge.js"></script>
    <script src="assets/js/email-automation.js"></script>
    <script src="assets/js/gtm-events.js"></script>
    <script src="assets/js/content-hub.js"></script>
    <script src="assets/js/config.js"></script>
    <!-- Analytics Integration (Amplitude + GA4 + Clarity) -->
    <script src="assets/js/analytics.js"></script>
    <script src="assets/js/index-app.js"></script>
    <!-- �?AudioManager兼容�?- 为旧模块提供window.audioManager -->
    <script src="assets/js/audioManager-compat.js"></script>
    <script src="assets/js/rating-system.js"></script>
    <script src="assets/js/touch-gestures.js"></script>
    <script src="assets/js/accessibility-enhancements.js"></script>

    <!-- Firebase 登录表单处理函数 -->
    <script>
        // 切换认证标签
        function switchAuthTab(tabName) {
            // 隐藏所有表单
            document.getElementById('loginForm').classList.remove('active');
            document.getElementById('signupForm').classList.remove('active');
            document.getElementById('resetForm').classList.remove('active');

            // 移除所有标签的active类
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // 显示选中的表单并激活标签
            switch(tabName) {
                case 'login':
                    document.getElementById('loginForm').classList.add('active');
                    document.querySelectorAll('.auth-tab')[0].classList.add('active');
                    break;
                case 'signup':
                    document.getElementById('signupForm').classList.add('active');
                    document.querySelectorAll('.auth-tab')[1].classList.add('active');
                    break;
                case 'reset':
                    document.getElementById('resetForm').classList.add('active');
                    document.querySelectorAll('.auth-tab')[2].classList.add('active');
                    break;
            }
        }

        // 处理登录
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert('请填写邮箱和密码');
                return;
            }

            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signInWithEmail(email, password);
                if (result) {
                    // 登录成功，关闭对话框
                    window.firebaseAuthManager.closeAuthDialog();
                    // 清空表单
                    document.getElementById('loginEmail').value = '';
                    document.getElementById('loginPassword').value = '';
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理注册
        async function handleSignup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;

            if (!name || !email || !password) {
                alert('请填写所有字段');
                return;
            }

            if (password.length < 6) {
                alert('密码至少需要6位字符');
                return;
            }

            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signUpWithEmail(email, password, name);
                if (result) {
                    // 注册成功，关闭对话框
                    window.firebaseAuthManager.closeAuthDialog();
                    // 清空表单
                    document.getElementById('signupName').value = '';
                    document.getElementById('signupEmail').value = '';
                    document.getElementById('signupPassword').value = '';
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理Google登录
        async function handleGoogleLogin() {
            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signInWithGoogle();
                if (result) {
                    window.firebaseAuthManager.closeAuthDialog();
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理匿名登录
        async function handleAnonymousLogin() {
            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.signInAnonymously();
                if (result) {
                    window.firebaseAuthManager.closeAuthDialog();
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 处理密码重置
        async function handlePasswordReset() {
            const email = document.getElementById('resetEmail').value;

            if (!email) {
                alert('请输入邮箱地址');
                return;
            }

            if (window.firebaseAuthManager) {
                const result = await window.firebaseAuthManager.sendPasswordResetEmail(email);
                if (result) {
                    // 重置邮件发送成功
                    alert('密码重置邮件已发送，请检查您的邮箱');
                    window.firebaseAuthManager.closeAuthDialog();
                    document.getElementById('resetEmail').value = '';
                }
            } else {
                console.error('Firebase Auth Manager 未初始化');
            }
        }

        // 监听Enter键提交表单
        document.addEventListener('DOMContentLoaded', () => {
            // 登录表单
            const loginPassword = document.getElementById('loginPassword');
            if (loginPassword) {
                loginPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleLogin();
                    }
                });
            }

            // 注册表单
            const signupPassword = document.getElementById('signupPassword');
            if (signupPassword) {
                signupPassword.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handleSignup();
                    }
                });
            }

            // 重置表单
            const resetEmail = document.getElementById('resetEmail');
            if (resetEmail) {
                resetEmail.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        handlePasswordReset();
                    }
                });
            }
        });
    </script>

    <!-- 初始化主题管理器 -->
    <script>
        // 在DOM加载后初始化主题管理器
        document.addEventListener('DOMContentLoaded', () => {
            window.themeManager = new ThemeManager();
            console.log('✅ 主题管理器已初始化');
        });
    </script>
</body>
</html>








