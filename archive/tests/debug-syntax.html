<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>语法错误调试</title>
</head>
<body>
    <h1>JavaScript 语法错误调试</h1>
    <div id="results"></div>

    <script>
        // Try to load and parse the main app's JavaScript
        function debugSyntax() {
            const results = document.getElementById('results');

            // Fetch the main HTML file
            fetch('index.html')
                .then(response => response.text())
                .then(html => {
                    // Extract script content
                    const scriptMatches = html.match(/<script[^>]*>([\s\S]*?)<\/script>/g);

                    if (scriptMatches) {
                        scriptMatches.forEach((scriptMatch, index) => {
                            try {
                                // Extract just the JavaScript content
                                const jsContent = scriptMatch.replace(/<script[^>]*>/, '').replace(/<\/script>/, '');

                                // Try to parse it
                                new Function(jsContent);
                                results.innerHTML += `<div style="color: green;">Script ${index + 1}: OK</div>`;
                            } catch (e) {
                                results.innerHTML += `<div style="color: red;">Script ${index + 1}: Error - ${e.message}</div>`;

                                // Try to find the error location
                                const lines = jsContent.split('\n');
                                results.innerHTML += `<div style="margin-left: 20px;">Checking around line ${e.lineNumber || 'unknown'}...</div>`;

                                // Show some context around the error
                                const errorLine = e.lineNumber - 1 || 0;
                                for (let i = Math.max(0, errorLine - 2); i <= Math.min(lines.length - 1, errorLine + 2); i++) {
                                    const marker = i === errorLine ? ' >>> ' : '     ';
                                    results.innerHTML += `<div style="font-family: monospace;">${marker}${i + 1}: ${lines[i].replace(/</g, '&lt;').replace(/>/g, '&gt;')}</div>`;
                                }
                            }
                        });
                    } else {
                        results.innerHTML = '<div style="color: red;">No script tags found</div>';
                    }
                })
                .catch(error => {
                    results.innerHTML = `<div style="color: red;">Failed to load index.html: ${error.message}</div>`;
                });
        }

        // Run debug when page loads
        window.onload = debugSyntax;
    </script>
</body>
</html>